import{r as c,j as e,F as Ue,c as Ve,R as _e}from"./react-D-CDmPwv.js";import{C as be,V as Je,T as z,S as Ye,P as Qe,W as Ke,a as Xe,A as Ze,b as et,D as he,G as tt,c as rt,d as st,e as ot,M as ye,O as at,f as nt,g as it,h as lt}from"./three-fPji1luv.js";import{G as ct}from"./vendor-BO8u8WSt.js";import"./monaco-BLmU3WdI.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=s(a);fetch(a.href,n)}})();const dt="modulepreload",mt=function(t){return"/"+t},we={},ut=function(r,s,o){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=i?.nonce||i?.getAttribute("nonce");a=Promise.allSettled(s.map(v=>{if(v=mt(v),v in we)return;we[v]=!0;const u=v.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${m}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":dt,u||(h.as="script"),h.crossOrigin="",h.href=v,d&&h.setAttribute("nonce",d),document.head.appendChild(h),u)return new Promise((w,b)=>{h.addEventListener("load",w),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${v}`)))})}))}function n(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return a.then(i=>{for(const d of i||[])d.status==="rejected"&&n(d.reason);return r().catch(n)})},ht={en:{welcome:{title:"MORPHOS",subtitle:"Parametric 3D Parts Generator",description:"Professional technical parts with precise dimensions",tagline:"AI-powered parametric design for engineers, makers, and product designers",getStarted:"Start Creating",useCases:{title:"WHO IS MORPHOS FOR?",productDesigner:{title:"Product Designers",desc:"Custom mechanical parts with exact dimensions for rapid prototyping"},electronics:{title:"Electronics Engineers",desc:"PCB enclosures, component mounts, and custom connectors"},engineer:{title:"Mechanical Engineers",desc:"Replacement parts, fixtures, and industrial-grade components"},maker:{title:"Makers & Hobbyists",desc:"Functional parts for DIY projects and technical repairs"}},features:{title:"WHY MORPHOS?",precision:{title:"Parametric Precision",desc:"Exact dimensions to the millimeter with ISO/DIN standards"},ai:{title:"Technical AI",desc:"Understands engineering vocabulary and generates parametric JSCAD code"},export:{title:"Professional Export",desc:"STL, G-Code, OBJ, 3MF - Ready for manufacturing"}},examples:{title:"GENERATE IN SECONDS",screw:"M8 x 30mm screw",enclosure:"Arduino Uno enclosure",mount:"NEMA 17 motor mount",connector:"DIN rail connector"}},nav:{projects:"Projects",newProject:"New Project",parameters:"Parameters",settings:"Settings"},actions:{create:"Create",modify:"Modify",adjust:"Adjust",export:"Export",download:"Download",save:"Save",cancel:"Cancel",close:"Close",delete:"Delete",code:"Code",retry:"Retry"},chat:{title:"AI Assistant",subtitle:"Morphos AI",placeholder:"Describe your 3D model...",listening:"Listening...",generating:"Generating...",analyzingRequest:"Analyzing your request...",generatingCode:"Generating JSCAD code...",pleaseWaitGeneration:"Please wait, this may take a few moments...",uploadSketch:"Upload sketch",speakTo3D:"Speak to 3D",quotaInfo:"Free API - Limit: 5 requests/day",quotaDesc:"If you exceed the limit, wait 24h or use your own API key.",learnMore:"Learn more"},mobileWarning:{title:"Desktop Mode Required",description:'MORPHOS is a 3D modeling application that requires a large screen. Please use a computer or enable "Desktop Mode" in your mobile browser for the best experience.',howToEnable:"How to enable desktop mode:",chrome:'Chrome: Menu → "Desktop site"',safari:'Safari: Tap "aA" → "Request Desktop Website"',firefox:'Firefox: Menu → "Request Desktop Site"',close:"Close",continueAnyway:"Continue anyway"},prompts:{create:{cube:"Create Cube",cylinder:"Create Cylinder",box:"Create Box",table:"Create Table",washer:"Create Washer",nut:"Create Nut"},modify:{increaseSize:"Increase Size",makeThinner:"Make Thinner",addHoles:"Add Holes",addChamfer:"Add Chamfer",aluminum:"Aluminum",redPlastic:"Red Plastic"}},messages:{noProject:"No Project",noModel:"No model",compiling:"Compiling...",createToday:"What will you create today?",describeModel:"Describe your 3D model to get started",startCreating:"Start Creating",clickToStart:"Click to start creating",describeYourModel:"Describe your 3D model",modifyYourModel:"Modify your model",noModelSelected:"No Model Selected",createModelToAdjust:"Create a model to adjust parameters",noParametersFound:"No Parameters Found",parametersAutoDetected:"Parameters are auto-detected from the code",changesUpdateRealtime:"Changes update the model in real-time",currentModel:"Current Model",rendering3D:"Rendering 3D model...",compilingJSCAD:"Compiling JSCAD code...",processingGeometry:"Processing geometry...",pleaseWaitRendering:"Please wait, rendering may take a moment...",resetToOriginal:"Reset to original values",collapseParameters:"Collapse parameters",expandParameters:"Expand parameters",savePreset:"Save Preset",savedPresets:"Saved Presets",presetName:"Preset name:"},errors:{quotaExceeded:"API quota exceeded. Free limit reached (5 requests/day). Please try again later or check your API plan.",invalidApiKey:"Invalid or missing API key. Check your configuration.",networkError:"Connection error. Check your internet connection.",generationError:"An error occurred during generation.",invalidPrompt:"Invalid or empty prompt.",invalidImage:"Invalid image. Please upload a valid image (PNG, JPEG, GIF, WebP) under 5MB."},export:{title:"Export Model",format:"Format",settings:"Settings",gcode:"G-Code Settings",layerHeight:"Layer Height",nozzleTemp:"Nozzle Temperature",bedTemp:"Bed Temperature",printSpeed:"Print Speed",travelSpeed:"Travel Speed",infillDensity:"Infill Density"},settings:{language:"Language",theme:"Theme",apiKey:"API Key"},materials:{title:"Materials",category:"Category",color:"Color",metalness:"Metalness",roughness:"Roughness",opacity:"Opacity",presets:"Presets",brushedAlu:"Brushed Alu",polishedSteel:"Polished Steel",mattePlastic:"Matte Plastic",transparent:"Transparent",metals:"Metals",plastics:"Plastics",others:"Others"}},fr:{welcome:{title:"MORPHOS",subtitle:"Générateur de Pièces 3D Paramétriques",description:"Pièces techniques professionnelles avec dimensions précises",tagline:"Conception paramétrique par IA pour ingénieurs, makers et designers produit",getStarted:"Commencer",useCases:{title:"POUR QUI EST MORPHOS ?",productDesigner:{title:"Designers Produit",desc:"Pièces mécaniques sur mesure avec dimensions exactes pour prototypage rapide"},electronics:{title:"Électroniciens",desc:"Boîtiers PCB, supports de composants et connecteurs personnalisés"},engineer:{title:"Ingénieurs Mécaniques",desc:"Pièces de rechange, fixations et composants de qualité industrielle"},maker:{title:"Makers & Hobbyistes",desc:"Pièces fonctionnelles pour projets DIY et réparations techniques"}},features:{title:"POURQUOI MORPHOS ?",precision:{title:"Précision Paramétrique",desc:"Dimensions exactes au millimètre avec normes ISO/DIN"},ai:{title:"IA Technique",desc:"Comprend le vocabulaire technique et génère du code JSCAD paramétrique"},export:{title:"Export Professionnel",desc:"STL, G-Code, OBJ, 3MF - Prêt pour la fabrication"}},examples:{title:"GÉNÉREZ EN QUELQUES SECONDES",screw:"Vis M8 x 30mm",enclosure:"Boîtier Arduino Uno",mount:"Support moteur NEMA 17",connector:"Connecteur rail DIN"}},nav:{projects:"Projets",newProject:"Nouveau Projet",parameters:"Paramètres",settings:"Réglages"},actions:{create:"Créer",modify:"Modifier",adjust:"Ajuster",export:"Exporter",download:"Télécharger",save:"Enregistrer",cancel:"Annuler",close:"Fermer",delete:"Supprimer",code:"Code",retry:"Réessayer"},chat:{title:"Assistant IA",subtitle:"Morphos IA",placeholder:"Décrivez votre modèle 3D...",listening:"Écoute...",generating:"Génération...",analyzingRequest:"Analyse de votre demande...",generatingCode:"Génération du code JSCAD...",pleaseWaitGeneration:"Veuillez patienter, cela peut prendre quelques instants...",uploadSketch:"Télécharger un croquis",speakTo3D:"Parler en 3D",quotaInfo:"API Gratuite - Limite: 5 requêtes/jour",quotaDesc:"Si vous dépassez la limite, attendez 24h ou utilisez votre propre clé API.",learnMore:"En savoir plus"},mobileWarning:{title:"Mode Bureau Requis",description:'MORPHOS est une application de modélisation 3D qui nécessite un écran large. Veuillez utiliser un ordinateur ou activer le "Mode Bureau" sur votre navigateur mobile pour une expérience optimale.',howToEnable:"Comment activer le mode bureau :",chrome:'Chrome: Menu → "Version pour ordinateur"',safari:'Safari: Touchez "aA" → "Voir la version ordinateur"',firefox:'Firefox: Menu → "Site pour ordinateur"',close:"Fermer",continueAnyway:"Continuer quand même"},prompts:{create:{cube:"Créer Cube",cylinder:"Créer Cylindre",box:"Créer Boîte",table:"Créer Table",washer:"Créer Rondelle",nut:"Créer Écrou"},modify:{increaseSize:"Augmenter Taille",makeThinner:"Réduire Épaisseur",addHoles:"Ajouter Trous",addChamfer:"Ajouter Chanfreins",aluminum:"Aluminium",redPlastic:"Plastique Rouge"}},messages:{noProject:"Aucun Projet",noModel:"Aucun modèle",compiling:"Compilation...",createToday:"Que créerez-vous aujourd'hui ?",describeModel:"Décrivez votre modèle 3D pour commencer",startCreating:"Commencer à Créer",clickToStart:"Cliquez pour commencer",describeYourModel:"Décrivez votre modèle 3D",modifyYourModel:"Modifiez votre modèle",noModelSelected:"Aucun Modèle Sélectionné",createModelToAdjust:"Créez un modèle pour ajuster les paramètres",noParametersFound:"Aucun Paramètre Trouvé",parametersAutoDetected:"Les paramètres sont détectés automatiquement depuis le code",changesUpdateRealtime:"Les modifications mettent à jour le modèle en temps réel",currentModel:"Modèle Actuel",rendering3D:"Rendu du modèle 3D...",compilingJSCAD:"Compilation du code JSCAD...",processingGeometry:"Traitement de la géométrie...",pleaseWaitRendering:"Veuillez patienter, le rendu peut prendre un moment...",resetToOriginal:"Réinitialiser aux valeurs d'origine",collapseParameters:"Réduire les paramètres",expandParameters:"Développer les paramètres",savePreset:"Enregistrer Préréglage",savedPresets:"Préréglages Enregistrés",presetName:"Nom du préréglage :"},errors:{quotaExceeded:"Quota API dépassé. Limite gratuite atteinte (5 requêtes/jour). Veuillez réessayer plus tard ou vérifier votre plan API.",invalidApiKey:"Clé API invalide ou manquante. Vérifiez votre configuration.",networkError:"Erreur de connexion. Vérifiez votre connexion internet.",generationError:"Une erreur est survenue lors de la génération.",invalidPrompt:"Prompt invalide ou vide.",invalidImage:"Image invalide. Veuillez télécharger une image valide (PNG, JPEG, GIF, WebP) de moins de 5MB."},export:{title:"Exporter le Modèle",format:"Format",settings:"Paramètres",gcode:"Paramètres G-Code",layerHeight:"Hauteur de Couche",nozzleTemp:"Température Buse",bedTemp:"Température Plateau",printSpeed:"Vitesse d'Impression",travelSpeed:"Vitesse de Déplacement",infillDensity:"Densité de Remplissage"},settings:{language:"Langue",theme:"Thème",apiKey:"Clé API"},materials:{title:"Matériaux",category:"Catégorie",color:"Couleur",metalness:"Métal",roughness:"Rugosité",opacity:"Opacité",presets:"Préréglages",brushedAlu:"Alu Brossé",polishedSteel:"Acier Poli",mattePlastic:"Plastique Mat",transparent:"Transparent",metals:"Métaux",plastics:"Plastiques",others:"Autres"}}},Re=c.createContext(void 0),xt=({children:t})=>{const[r,s]=c.useState(()=>localStorage.getItem("morphos-language")||"en");c.useEffect(()=>{localStorage.setItem("morphos-language",r)},[r]);const a={language:r,setLanguage:n=>{s(n)},t:ht[r]};return e.jsx(Re.Provider,{value:a,children:t})},q=()=>{const t=c.useContext(Re);if(!t)throw new Error("useLanguage must be used within LanguageProvider");return t},De=c.createContext(void 0),pt=({children:t})=>{const[r,s]=c.useState(()=>localStorage.getItem("morphos-theme")||"dark");c.useEffect(()=>{localStorage.setItem("morphos-theme",r),document.documentElement.classList.add("theme-transitioning"),document.documentElement.classList.toggle("light",r==="light"),document.documentElement.classList.toggle("dark",r==="dark"),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},300)},[r]);const o=()=>{s(a=>a==="dark"?"light":"dark")};return e.jsx(De.Provider,{value:{theme:r,toggleTheme:o},children:t})},ie=()=>{const t=c.useContext(De);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t},g={Cube:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),Diameter:({className:t="w-5 h-5"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:2}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"21",strokeWidth:2,strokeDasharray:"2 2"})]}),Width:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12M8 12h12M8 17h12M4 7h.01M4 12h.01M4 17h.01"})}),Height:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),Sliders:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),Rotate:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Hash:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})}),Settings:({className:t="w-5 h-5"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Code:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),Download:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),Plus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Close:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),ChevronLeft:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),ChevronRight:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),ChevronDown:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),ChevronUp:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),Folder:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),User:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Eye:({className:t="w-3 h-3"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Chat:({className:t="w-7 h-7"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),Image:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Microphone:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),Send:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),Info:({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Alert:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Refresh:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Spinner:({className:t="w-3 h-3"})=>e.jsx("div",{className:`${t} border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin`}),Robot:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),Wrench:({className:t="w-6 h-6"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Package:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),Sparkles:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Bolt:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Circle:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:2})}),Hexagon:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2l9 5v10l-9 5-9-5V7l9-5z"})}),Cylinder:({className:t="w-6 h-6"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",strokeWidth:2}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5v14c0 1.657 4.03 3 9 3s9-1.343 9-3V5"})]}),Sun:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),Moon:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),ArrowsExpand:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),ArrowsContract:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25"})}),Adjustments:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),Duplicate:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),ViewGrid:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Globe:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Translate:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),Logout:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),Palette:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),Chip:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),Pencil:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),Cog:({className:t="w-6 h-6"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Tool:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.121 14.121L19 19m-7-7l7-7m-7 7l-2.879 2.879M12 12L9.121 9.121m0 5.758a3 3 0 10-4.243 4.243 3 3 0 004.243-4.243zm0-5.758a3 3 0 10-4.243-4.243 3 3 0 004.243 4.243z"})}),Ruler:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),Lightning:({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Check:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),HeroIllustration:({className:t="w-full h-full"})=>e.jsxs("svg",{className:t,viewBox:"0 0 400 300",fill:"none",children:[e.jsxs("g",{opacity:"0.6",children:[e.jsx("path",{d:"M200 50 L280 90 L280 170 L200 210 L120 170 L120 90 Z",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("path",{d:"M200 50 L200 130",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4"}),e.jsx("path",{d:"M120 90 L200 130 L280 90",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M200 130 L200 210",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M120 170 L200 210 L280 170",stroke:"currentColor",strokeWidth:"2"})]}),e.jsxs("g",{opacity:"0.4",children:[e.jsx("line",{x1:"100",y1:"90",x2:"100",y2:"170",stroke:"currentColor",strokeWidth:"1"}),e.jsx("line",{x1:"95",y1:"90",x2:"105",y2:"90",stroke:"currentColor",strokeWidth:"1"}),e.jsx("line",{x1:"95",y1:"170",x2:"105",y2:"170",stroke:"currentColor",strokeWidth:"1"}),e.jsx("text",{x:"85",y:"135",fill:"currentColor",fontSize:"10",fontFamily:"monospace",children:"80mm"})]}),e.jsxs("g",{opacity:"0.1",children:[[...Array(8)].map((r,s)=>e.jsx("line",{x1:"50",y1:50+s*30,x2:"350",y2:50+s*30,stroke:"currentColor",strokeWidth:"0.5"},`h${s}`)),[...Array(10)].map((r,s)=>e.jsx("line",{x1:50+s*30,y1:"50",x2:50+s*30,y2:"260",stroke:"currentColor",strokeWidth:"0.5"},`v${s}`))]})]}),GearIllustration:({className:t="w-full h-full"})=>e.jsxs("svg",{className:t,viewBox:"0 0 200 200",fill:"none",children:[e.jsx("circle",{cx:"100",cy:"100",r:"60",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),e.jsx("circle",{cx:"100",cy:"100",r:"30",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),[...Array(8)].map((r,s)=>{const o=s*45*Math.PI/180,a=100+Math.cos(o)*60,n=100+Math.sin(o)*60,i=100+Math.cos(o)*75,d=100+Math.sin(o)*75;return e.jsx("line",{x1:a,y1:n,x2:i,y2:d,stroke:"currentColor",strokeWidth:"8",opacity:"0.6"},s)})]}),ScrewIllustration:({className:t="w-full h-full"})=>e.jsxs("svg",{className:t,viewBox:"0 0 200 200",fill:"none",children:[e.jsx("rect",{x:"85",y:"40",width:"30",height:"120",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),e.jsx("circle",{cx:"100",cy:"30",r:"20",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),e.jsx("line",{x1:"90",y1:"30",x2:"110",y2:"30",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),[...Array(10)].map((r,s)=>e.jsx("line",{x1:"85",y1:50+s*10,x2:"115",y2:55+s*10,stroke:"currentColor",strokeWidth:"1",opacity:"0.4"},s))]}),BoxIllustration:({className:t="w-full h-full"})=>e.jsxs("svg",{className:t,viewBox:"0 0 200 200",fill:"none",children:[e.jsx("path",{d:"M50 80 L100 50 L150 80 L150 150 L100 180 L50 150 Z",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.6"}),e.jsx("path",{d:"M50 80 L100 110 L150 80",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"}),e.jsx("path",{d:"M100 50 L100 110",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 4",opacity:"0.4"}),e.jsx("path",{d:"M100 110 L100 180",stroke:"currentColor",strokeWidth:"2",opacity:"0.6"})]})},gt="bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 shadow-md",vt="bg-[var(--bg-tertiary)] hover:bg-[var(--bg-tertiary)]/80 border border-[var(--border-color)]",ft="hover:bg-[var(--bg-tertiary)] transition-fast",bt="px-3 py-1.5 text-xs",jt="px-4 py-2 text-sm",yt="px-6 py-3 text-base",wt="rounded-lg font-medium flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",Ie="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",Fe="bg-[var(--bg-tertiary)] rounded-2xl shadow-2xl w-full flex flex-col animate-slideUp",We="px-6 py-4 border-t border-[var(--border-color)] bg-[var(--bg-secondary)]/50 flex items-center justify-between flex-shrink-0",kt="bg-[var(--bg-secondary)]/50 rounded-xl p-4 border border-[var(--border-color)]",Ct="p-2 hover:bg-[var(--bg-tertiary)] rounded-lg transition-fast";function ke({variant:t="secondary",size:r="md",className:s="",children:o,...a}){const n={primary:gt,secondary:vt,ghost:ft},i={sm:bt,md:jt,lg:yt};return e.jsx("button",{className:`${wt} ${n[t]} ${i[r]} ${s}`,...a,children:o})}function Nt({className:t="",children:r,...s}){return e.jsx("button",{className:`${Ct} ${t}`,...s,children:r})}function Mt({onClick:t,isExpanded:r}){return e.jsx("button",{onClick:t,className:"w-10 h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center shadow-lg hover:scale-110 transition-transform","aria-label":r?"Collapse":"Expand",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${r?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}function xe({label:t,value:r,min:s,max:o,step:a,onChange:n,formatValue:i=v=>v.toString(),showValue:d=!0}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-xs font-medium",children:t}),d&&e.jsx("span",{className:"text-xs text-[var(--text-tertiary)]",children:i(r)})]}),e.jsx("input",{type:"range",min:s,max:o,step:a,value:r,onChange:v=>n(parseFloat(v.target.value)),className:"slider w-full"})]})}function pe({children:t,className:r="",gap:s="md",align:o="center",justify:a="start",direction:n="row"}){const i={xs:"gap-1",sm:"gap-2",md:"gap-3",lg:"gap-4"},d={start:"items-start",center:"items-center",end:"items-end",stretch:"items-stretch"},v={start:"justify-start",center:"justify-center",end:"justify-end",between:"justify-between",around:"justify-around"},u={row:"flex-row",col:"flex-col"};return e.jsx("div",{className:`flex ${u[n]} ${i[s]} ${d[o]} ${v[a]} ${r}`,children:t})}function St({children:t,className:r="",padding:s="md",hover:o=!1}){const a={sm:"p-3",md:"p-4",lg:"p-6"};return e.jsx("div",{className:`rounded-xl bg-[var(--bg-tertiary)]/80 border border-[var(--border-color)]/50 ${a[s]} ${o?"hover:border-[var(--border-color)] transition-fast":""} ${r}`,children:t})}function Lt({icon:t,title:r,description:s,action:o}){return e.jsxs("div",{className:"text-center text-[var(--text-tertiary)] py-8",children:[t&&e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 bg-[var(--bg-tertiary)]/50 rounded-xl flex items-center justify-center border border-[var(--border-color)]/50",children:t}),e.jsx("p",{className:"text-sm font-medium mb-1",children:r}),s&&e.jsx("p",{className:"text-xs text-[var(--text-tertiary)]",children:s}),o&&e.jsx("div",{className:"mt-4",children:o})]})}function Et({value:t,onChange:r,label:s}){return e.jsxs("div",{children:[s&&e.jsx("label",{className:"block text-xs font-medium mb-2",children:s}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:t,onChange:o=>r(o.target.value),className:"w-12 h-12 rounded-lg border-2 border-[var(--border-color)] cursor-pointer"}),e.jsx("input",{type:"text",value:t,onChange:o=>r(o.target.value),className:"flex-1 px-3 py-2 bg-[var(--bg-tertiary)] rounded-lg text-xs font-mono border border-[var(--border-color)] focus:outline-none focus:border-[var(--accent)]",placeholder:"#FFFFFF"})]})]})}function At({tabs:t,activeTab:r,onChange:s,size:o="md"}){const a={sm:"px-2 py-1.5 text-xs",md:"px-3 py-2 text-xs"};return e.jsx("div",{className:"flex gap-1 bg-[var(--bg-tertiary)] rounded-lg p-1",children:t.map(n=>e.jsxs("button",{onClick:()=>s(n.id),className:`flex-1 ${a[o]} rounded-md font-medium transition-all flex items-center justify-center gap-2 ${r===n.id?"bg-[var(--accent)] text-[var(--bg-primary)]":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,children:[n.icon,n.label]},n.id))})}function Oe({size:t="md"}){const{language:r,setLanguage:s}=q(),o=t==="sm"?"px-2 md:px-3 py-1 md:py-1.5":"px-3 py-1.5";return e.jsxs("div",{className:`flex gap-${t==="sm"?"0.5 md:gap-1":"1"} bg-[var(--bg-tertiary)] rounded-${t==="sm"?"md md:rounded-lg":"lg"} p-${t==="sm"?"0.5 md:p-1":"1"} border border-[var(--border-color)]`,children:[e.jsx("button",{onClick:()=>s("en"),className:`${o} rounded-md text-xs font-medium transition-all ${r==="en"?"bg-[var(--accent)] text-[var(--bg-primary)]":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,title:"English",children:"EN"}),e.jsx("button",{onClick:()=>s("fr"),className:`${o} rounded-md text-xs font-medium transition-all ${r==="fr"?"bg-[var(--accent)] text-[var(--bg-primary)]":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,title:"Français",children:"FR"})]})}function ze({size:t="md"}){const{theme:r,toggleTheme:s}=ie(),o=t==="sm"?"p-1.5 md:p-2":"p-2",a=t==="sm"?"w-4 h-4 md:w-5 md:h-5":"w-5 h-5";return e.jsx("button",{onClick:s,className:`${o} hover:bg-[var(--bg-tertiary)] rounded-${t==="sm"?"md md:rounded-lg":"lg"} transition-colors ${t==="sm"?"border border-[var(--border-color)]":""}`,title:r==="dark"?"Light mode":"Dark mode",children:e.jsx("div",{className:r==="dark"?"theme-icon-sun":"theme-icon-moon",children:r==="dark"?e.jsx(g.Sun,{className:a}):e.jsx(g.Moon,{className:a})})})}function Be({title:t,subtitle:r,icon:s,onClose:o}){return e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--border-color)] flex items-center justify-between flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center",children:s}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:t}),r&&e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:r})]})]}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-[var(--bg-secondary)] rounded-lg transition-colors","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function $e({children:t,icon:r,loading:s=!1,disabled:o,className:a="",...n}){return e.jsx("button",{disabled:o||s,className:`px-6 py-2 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-all font-medium flex items-center gap-2 ${a}`,...n,children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),t]}):e.jsxs(e.Fragment,{children:[r,t]})})}function Pt({onGetStarted:t}){const{t:r,language:s,setLanguage:o}=q(),{theme:a,toggleTheme:n}=ie(),[i,d]=c.useState(!1),v=()=>{window.innerWidth<1024?d(!0):t()};return e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] overflow-y-auto",children:[i&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-2xl p-6 max-w-md w-full shadow-2xl animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl flex items-center justify-center",children:e.jsx(g.Alert,{className:"w-6 h-6 text-[var(--text-primary)]"})}),e.jsx("h3",{className:"text-lg font-bold",children:r.mobileWarning.title})]}),e.jsx("p",{className:"text-[var(--text-secondary)] mb-6",children:r.mobileWarning.description}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--text-secondary)] mb-2 font-medium",children:[e.jsx(g.Info,{className:"w-4 h-4"}),e.jsx("span",{children:r.mobileWarning.howToEnable})]}),e.jsxs("ul",{className:"text-xs text-[var(--text-tertiary)] space-y-1 ml-6",children:[e.jsxs("li",{children:["• ",r.mobileWarning.chrome]}),e.jsxs("li",{children:["• ",r.mobileWarning.safari]}),e.jsxs("li",{children:["• ",r.mobileWarning.firefox]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"flex-1 px-4 py-3 bg-[var(--bg-tertiary)] text-[var(--text-primary)] hover:bg-[var(--bg-primary)] rounded-lg font-medium transition-all",children:r.mobileWarning.close}),e.jsx("button",{onClick:()=>{d(!1),t()},className:"flex-1 px-4 py-3 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-lg font-medium transition-all",children:r.mobileWarning.continueAnyway})]})]})}),e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-[var(--bg-secondary)]/95 backdrop-blur-xl border-b border-[var(--border-color)]",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg md:rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(g.Cube,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx("span",{className:"font-bold text-lg md:text-2xl tracking-tight",children:r.welcome.title})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx(Oe,{size:"sm"}),e.jsx(ze,{size:"sm"})]})]})}),e.jsx("section",{className:"pt-24 md:pt-32 pb-16 md:pb-20 px-4 md:px-6",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 lg:gap-12 items-center",children:[e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 md:px-4 py-1.5 md:py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-full mb-6 md:mb-8",children:[e.jsx(g.Lightning,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"text-xs md:text-sm font-medium",children:r.welcome.tagline})]}),e.jsx("h1",{className:"hero-title text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold mb-4 md:mb-6 tracking-tight",children:r.welcome.title}),e.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-[var(--text-secondary)] mb-3 md:mb-4",children:r.welcome.subtitle}),e.jsx("p",{className:"text-base md:text-xl text-[var(--text-tertiary)] mb-8 md:mb-12 max-w-2xl mx-auto lg:mx-0",children:r.welcome.description}),e.jsxs("button",{onClick:v,className:"px-6 md:px-8 py-3 md:py-4 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-xl font-semibold text-base md:text-lg transition-all duration-200 shadow-2xl hover:scale-105 inline-flex items-center gap-2 md:gap-3",children:[r.welcome.getStarted,e.jsx(g.ChevronRight,{className:"w-4 h-4 md:w-5 md:h-5"})]})]}),e.jsx("div",{className:"relative hidden lg:block",children:e.jsxs("div",{className:"aspect-[4/3] bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-2xl p-8 relative overflow-hidden",children:[e.jsx(g.HeroIllustration,{className:"w-full h-full text-[var(--text-primary)]"}),e.jsx("div",{className:"absolute top-4 right-4 px-3 py-1 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg text-xs font-mono",children:"ISO 9001"})]})})]})})}),e.jsx("section",{className:"py-12 md:py-20 px-4 md:px-6 bg-[var(--bg-secondary)]",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"section-title text-2xl md:text-3xl font-bold text-center mb-8 md:mb-12",children:r.welcome.useCases.title}),e.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl md:rounded-2xl p-4 md:p-6 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg md:rounded-xl flex items-center justify-center mb-3 md:mb-4",children:e.jsx(g.Pencil,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-2",children:r.welcome.useCases.productDesigner.title}),e.jsx("p",{className:"text-xs md:text-sm text-[var(--text-secondary)]",children:r.welcome.useCases.productDesigner.desc})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl md:rounded-2xl p-4 md:p-6 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg md:rounded-xl flex items-center justify-center mb-3 md:mb-4",children:e.jsx(g.Chip,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-2",children:r.welcome.useCases.electronics.title}),e.jsx("p",{className:"text-xs md:text-sm text-[var(--text-secondary)]",children:r.welcome.useCases.electronics.desc})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl md:rounded-2xl p-4 md:p-6 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg md:rounded-xl flex items-center justify-center mb-3 md:mb-4",children:e.jsx(g.Cog,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-2",children:r.welcome.useCases.engineer.title}),e.jsx("p",{className:"text-xs md:text-sm text-[var(--text-secondary)]",children:r.welcome.useCases.engineer.desc})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl md:rounded-2xl p-4 md:p-6 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg md:rounded-xl flex items-center justify-center mb-3 md:mb-4",children:e.jsx(g.Tool,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-2",children:r.welcome.useCases.maker.title}),e.jsx("p",{className:"text-xs md:text-sm text-[var(--text-secondary)]",children:r.welcome.useCases.maker.desc})]})]})]})}),e.jsx("section",{className:"py-12 md:py-20 px-4 md:px-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"section-title text-2xl md:text-3xl font-bold text-center mb-8 md:mb-12",children:r.welcome.features.title}),e.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-6 md:gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl md:rounded-2xl flex items-center justify-center mx-auto mb-4 md:mb-6 shadow-xl",children:e.jsx(g.Ruler,{className:"w-7 h-7 md:w-8 md:h-8"})}),e.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-2 md:mb-3",children:r.welcome.features.precision.title}),e.jsx("p",{className:"text-sm md:text-base text-[var(--text-secondary)] px-2",children:r.welcome.features.precision.desc})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl md:rounded-2xl flex items-center justify-center mx-auto mb-4 md:mb-6 shadow-xl",children:e.jsx(g.Robot,{className:"w-7 h-7 md:w-8 md:h-8"})}),e.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-2 md:mb-3",children:r.welcome.features.ai.title}),e.jsx("p",{className:"text-sm md:text-base text-[var(--text-secondary)] px-2",children:r.welcome.features.ai.desc})]}),e.jsxs("div",{className:"text-center sm:col-span-2 md:col-span-1",children:[e.jsx("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl md:rounded-2xl flex items-center justify-center mx-auto mb-4 md:mb-6 shadow-xl",children:e.jsx(g.Download,{className:"w-7 h-7 md:w-8 md:h-8"})}),e.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-2 md:mb-3",children:r.welcome.features.export.title}),e.jsx("p",{className:"text-sm md:text-base text-[var(--text-secondary)] px-2",children:r.welcome.features.export.desc})]})]}),e.jsx("div",{className:"mt-12 md:mt-16 bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-2xl p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(g.Chat,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-semibold",children:s==="fr"?"Décrivez":"Describe"}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)] mt-1",children:s==="fr"?"En langage naturel":"In natural language"})]}),e.jsx(g.ChevronRight,{className:"w-6 h-6 text-[var(--text-tertiary)] rotate-90 md:rotate-0"}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(g.Robot,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-semibold",children:s==="fr"?"Générez":"Generate"}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)] mt-1",children:s==="fr"?"Code paramétrique":"Parametric code"})]}),e.jsx(g.ChevronRight,{className:"w-6 h-6 text-[var(--text-tertiary)] rotate-90 md:rotate-0"}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(g.Sliders,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-semibold",children:s==="fr"?"Ajustez":"Adjust"}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)] mt-1",children:s==="fr"?"Paramètres en temps réel":"Real-time parameters"})]}),e.jsx(g.ChevronRight,{className:"w-6 h-6 text-[var(--text-tertiary)] rotate-90 md:rotate-0"}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(g.Download,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-semibold",children:s==="fr"?"Exportez":"Export"}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)] mt-1",children:s==="fr"?"Prêt à imprimer":"Ready to print"})]})]})})]})}),e.jsx("section",{className:"py-12 md:py-20 px-4 md:px-6 bg-[var(--bg-secondary)]",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h2",{className:"section-title text-2xl md:text-3xl font-bold text-center mb-8 md:mb-12",children:r.welcome.examples.title}),e.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl p-4 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"aspect-square mb-3 flex items-center justify-center",children:e.jsx(g.ScrewIllustration,{className:"w-full h-full text-[var(--text-primary)]"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g.Check,{className:"text-[var(--accent)] flex-shrink-0 w-4 h-4"}),e.jsx("span",{className:"font-mono text-xs md:text-sm",children:r.welcome.examples.screw})]})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl p-4 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"aspect-square mb-3 flex items-center justify-center",children:e.jsx(g.BoxIllustration,{className:"w-full h-full text-[var(--text-primary)]"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g.Check,{className:"text-[var(--accent)] flex-shrink-0 w-4 h-4"}),e.jsx("span",{className:"font-mono text-xs md:text-sm",children:r.welcome.examples.enclosure})]})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl p-4 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"aspect-square mb-3 flex items-center justify-center",children:e.jsx(g.GearIllustration,{className:"w-full h-full text-[var(--text-primary)]"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g.Check,{className:"text-[var(--accent)] flex-shrink-0 w-4 h-4"}),e.jsx("span",{className:"font-mono text-xs md:text-sm",children:r.welcome.examples.mount})]})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-xl p-4 hover:border-[var(--accent)] transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"aspect-square mb-3 flex items-center justify-center",children:e.jsx(g.Cylinder,{className:"w-24 h-24 text-[var(--text-primary)]"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g.Check,{className:"text-[var(--accent)] flex-shrink-0 w-4 h-4"}),e.jsx("span",{className:"font-mono text-xs md:text-sm",children:r.welcome.examples.connector})]})]})]})]})}),e.jsx("section",{className:"py-12 md:py-20 px-4 md:px-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsx("h2",{className:"hero-title text-2xl sm:text-3xl md:text-4xl font-bold mb-4 md:mb-6 px-4",children:s==="fr"?"PRÊT À CRÉER VOS PIÈCES TECHNIQUES ?":"READY TO CREATE YOUR TECHNICAL PARTS?"}),e.jsx("p",{className:"text-base md:text-xl text-[var(--text-secondary)] mb-6 md:mb-8",children:s==="fr"?"Commencez gratuitement avec MORPHOS":"Start for free with MORPHOS"}),e.jsxs("button",{onClick:v,className:"px-8 md:px-10 py-4 md:py-5 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-xl font-bold text-lg md:text-xl transition-all duration-200 shadow-2xl hover:scale-105 inline-flex items-center gap-2 md:gap-3",children:[r.welcome.getStarted,e.jsx(g.ChevronRight,{className:"w-5 h-5 md:w-6 md:h-6"})]})]})}),e.jsx("footer",{className:"py-6 md:py-8 px-4 md:px-6 border-t border-[var(--border-color)] bg-[var(--bg-secondary)]",children:e.jsx("div",{className:"max-w-6xl mx-auto text-center text-xs md:text-sm text-[var(--text-tertiary)]",children:e.jsxs("p",{children:["© 2026 ",r.welcome.title," - ",s==="fr"?"Générateur de Pièces 3D Paramétriques":"Parametric 3D Parts Generator"]})})})]})}function Tt({project:t,currentModel:r,onModelSelect:s,onClose:o}){const a=n=>new Date(n).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",children:e.jsxs("div",{className:"bg-[var(--bg-tertiary)] rounded-xl shadow-2xl w-full max-w-3xl max-h-[80vh] flex flex-col animate-slideUp",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--border-color)] flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:t.name}),e.jsxs("p",{className:"text-sm text-[var(--text-secondary)]",children:[t.models?.length||0," models"]})]})]}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t.models&&t.models.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.models.map((n,i)=>e.jsx("button",{onClick:()=>{s(n),o()},className:`p-4 rounded-xl border transition-all duration-200 text-left group hover:scale-[1.02] ${r?.id===n.id?"bg-[var(--accent)]/20 border-[var(--border-color)] shadow-lg":"bg-[var(--bg-secondary)]/50 border-[var(--border-color)]/50 hover:border-[var(--border-color)] hover:bg-[var(--bg-secondary)]/80"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 ${r?.id===n.id?"bg-[var(--accent)]/20":"bg-[var(--bg-tertiary)]"}`,children:e.jsx("svg",{className:`w-6 h-6 ${r?.id===n.id,"text-[var(--text-secondary)]"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r?.id===n.id&&e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full animate-pulse"}),e.jsx("h3",{className:`font-semibold truncate ${r?.id===n.id?"text-[var(--text-primary)]":"text-white"}`,children:n.name})]}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)] mb-2",children:a(n.createdAt)}),n.prompt&&e.jsx("p",{className:"text-xs text-[var(--text-secondary)] line-clamp-2",children:n.prompt})]}),e.jsx("svg",{className:"w-5 h-5 text-[var(--text-tertiary)] group-hover:text-[var(--text-secondary)] transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},n.id||i))}):e.jsxs("div",{className:"text-center py-12 text-[var(--text-tertiary)]",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("p",{children:"No models in this project"})]})}),e.jsx("div",{className:"px-6 py-4 border-t border-[var(--border-color)] bg-[var(--bg-secondary)]/50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-[var(--text-secondary)]",children:[e.jsx("span",{children:"Click on a model to view it"}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-[var(--bg-tertiary)] hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors",children:"Close"})]})})]})})}function oe(t){return t<1?t.toFixed(2):t<10?t.toFixed(1):t.toFixed(0)}function Ce(t){const r=typeof t=="string"?new Date(t):t,s=new Date,o=s.getTime()-r.getTime(),a=Math.floor(o/1e3),n=Math.floor(a/60),i=Math.floor(n/60),d=Math.floor(i/24);return a<60?"à l'instant":n<60?`il y a ${n} min`:i<24?`il y a ${i}h`:d<7?`il y a ${d}j`:r.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:r.getFullYear()!==s.getFullYear()?"numeric":void 0})}function Rt({currentProject:t,projects:r,onProjectSelect:s,onNewProject:o,onModelSelect:a,currentModel:n,isCollapsed:i,onToggleCollapse:d,onLogout:v}){const[u,m]=c.useState(t?.id||null),[h,w]=c.useState(null),[b,x]=c.useState(!1),[S,T]=c.useState(null),R=p=>{m(u===p?null:p)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${i?"w-16":"w-72"} bg-[var(--bg-secondary)] border-r border-[var(--border-color)] flex flex-col transition-all duration-300`,children:[e.jsx("div",{className:"p-4 border-b border-[var(--border-color)]/50",children:i?e.jsx("div",{className:"flex flex-col items-center gap-3",children:e.jsx("button",{onClick:d,className:"w-10 h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center shadow-lg hover:scale-110 transition-transform",title:"Expand sidebar",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-bold text-xl text-[var(--text-primary)]",children:"MORPHOS"}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)]",children:"AI 3D Generator"})]}),e.jsx("button",{onClick:d,className:"p-2 hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors flex-shrink-0",title:"Collapse sidebar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})]})}),e.jsx("div",{className:"p-3",children:e.jsxs("button",{onClick:o,className:`w-full ${i?"px-3 py-3":"px-4 py-3"} bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-xl font-medium transition-all duration-200 flex items-center justify-center gap-2 shadow-lg hover:scale-[1.02]`,title:i?"New Project":"",children:[e.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),!i&&e.jsx("span",{children:"New Project"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3",children:e.jsxs("div",{className:"mb-2",children:[!i&&e.jsxs("h3",{className:"text-xs font-semibold text-[var(--text-tertiary)] uppercase tracking-wider px-2 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Projects (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(p=>e.jsxs("div",{className:`rounded-xl overflow-hidden transition-all duration-200 ${t?.id===p.id?"bg-[var(--bg-tertiary)] border border-[var(--border-color)]":"bg-[var(--bg-tertiary)]/50 border border-[var(--border-color)]/50 hover:border-[var(--border-color)]"}`,children:[i?e.jsx("button",{onClick:()=>s(p),className:"w-full p-3 flex items-center justify-center",title:p.name,children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t?.id===p.id&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-[var(--accent)] rounded-full animate-pulse"}),p.models?.length>0&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-[var(--accent)] rounded-full text-[10px] flex items-center justify-center font-bold",children:p.models.length})]})}):e.jsxs("div",{className:"flex items-center gap-2 p-3",children:[e.jsxs("button",{onClick:()=>s(p),className:"flex-1 text-left min-w-0",children:[e.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[t?.id===p.id&&e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full animate-pulse"}),p.name]}),e.jsxs("div",{className:"text-xs text-[var(--text-tertiary)] flex items-center gap-2 mt-1",children:[e.jsxs("span",{children:[p.models?.length||0," models"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:Ce(p.updatedAt)})]})]}),p.models?.length>0&&e.jsx("button",{onClick:()=>R(p.id),className:"p-1.5 hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors",children:e.jsx("svg",{className:`w-4 h-4 transition-transform ${u===p.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!i&&u===p.id&&p.models?.length>0&&e.jsx("div",{className:"border-t border-[var(--border-color)]/50 bg-[var(--bg-secondary)]/30",children:e.jsxs("div",{className:"p-2 space-y-1",children:[p.models.slice(0,5).map((j,I)=>e.jsx("button",{onClick:()=>a(j),onMouseEnter:()=>w(j.id),onMouseLeave:()=>w(null),className:`w-full px-3 py-2 rounded-lg transition-colors group text-left ${n?.id===j.id?"bg-[var(--accent)]/30 border border-[var(--border-color)]/50":"hover:bg-[var(--bg-tertiary)]/50"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${n?.id===j.id,"text-[var(--text-secondary)]"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:`text-sm truncate flex items-center gap-2 ${n?.id===j.id?"font-semibold":""}`,children:[n?.id===j.id&&e.jsx("div",{className:"w-1.5 h-1.5 bg-[var(--accent)] rounded-full animate-pulse"}),j.name]}),e.jsx("div",{className:"text-xs text-[var(--text-tertiary)] truncate",children:Ce(j.createdAt)})]}),h===j.id&&e.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:P=>{P.stopPropagation(),a(j)},className:"p-1 hover:bg-[var(--bg-tertiary)] rounded",title:"View model",children:e.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})})]})},j.id||I)),p.models.length>5&&e.jsxs("button",{onClick:()=>{T(p),x(!0)},className:"w-full text-xs text-[var(--text-tertiary)] hover:text-[var(--text-secondary)] text-center py-2 hover:bg-[var(--bg-tertiary)]/30 rounded transition-colors",children:["View all ",p.models.length," models →"]})]})})]},p.id))})]})}),e.jsx("div",{className:"p-3 border-t border-[var(--border-color)]/50 bg-[var(--bg-secondary)]/50",children:i?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg flex items-center justify-center shadow-lg",title:"User",children:e.jsx(g.User,{})}),e.jsx("button",{onClick:v,className:"p-2 hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors group",title:"Logout",children:e.jsx(g.Logout,{className:"w-4 h-4 text-[var(--text-secondary)] group-hover:text-[var(--text-primary)]"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-[var(--bg-tertiary)]/50 rounded-lg p-2 border border-[var(--border-color)]/50",children:[e.jsx("div",{className:"text-xs text-[var(--text-tertiary)]",children:"Total Models"}),e.jsx("div",{className:"text-lg font-bold text-[var(--text-secondary)]",children:r.reduce((p,j)=>p+(j.models?.length||0),0)})]}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)]/50 rounded-lg p-2 border border-[var(--border-color)]/50",children:[e.jsx("div",{className:"text-xs text-[var(--text-tertiary)]",children:"Projects"}),e.jsx("div",{className:"text-lg font-bold text-[var(--text-secondary)]",children:r.length})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[var(--bg-tertiary)]/30 rounded-lg border border-[var(--border-color)]/50",children:[e.jsx("div",{className:"w-9 h-9 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx(g.User,{})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:"User"}),e.jsxs("div",{className:"text-xs text-[var(--text-tertiary)] flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-[var(--accent)] rounded-full"}),"Free Plan"]})]}),e.jsx("button",{onClick:v,className:"p-2 hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors group",title:"Logout",children:e.jsx(g.Logout,{className:"w-4 h-4 text-[var(--text-secondary)] group-hover:text-[var(--text-primary)]"})})]})]})})]}),b&&S&&e.jsx(Tt,{project:S,currentModel:n,onModelSelect:a,onClose:()=>{x(!1),T(null)}})]})}const ne={aluminum:{id:"aluminum",name:"Aluminium",type:"metal",color:"#C0C0C0",metalness:.9,roughness:.3,opacity:1,properties:{density:2.7,price:2.5,recyclable:!0,printable:!1,finish:"brushed"}},steel:{id:"steel",name:"Acier",type:"metal",color:"#808080",metalness:.95,roughness:.2,opacity:1,properties:{density:7.85,price:1.5,recyclable:!0,printable:!1,finish:"polished"}},stainlessSteel:{id:"stainlessSteel",name:"Acier Inoxydable",type:"metal",color:"#B8B8B8",metalness:.9,roughness:.25,opacity:1,properties:{density:8,price:3.5,recyclable:!0,printable:!1,finish:"polished"}},copper:{id:"copper",name:"Cuivre",type:"metal",color:"#B87333",metalness:.95,roughness:.15,opacity:1,properties:{density:8.96,price:8,recyclable:!0,printable:!1,finish:"polished"}},brass:{id:"brass",name:"Laiton",type:"metal",color:"#DAA520",metalness:.9,roughness:.2,opacity:1,properties:{density:8.5,price:5,recyclable:!0,printable:!1,finish:"polished"}},titanium:{id:"titanium",name:"Titane",type:"metal",color:"#A8A8A8",metalness:.85,roughness:.35,opacity:1,properties:{density:4.5,price:25,recyclable:!0,printable:!1,finish:"brushed"}},abs:{id:"abs",name:"ABS",type:"plastic",color:"#FFFFFF",metalness:0,roughness:.6,opacity:1,properties:{density:1.05,price:2,recyclable:!0,printable:!0,finish:"matte"}},pla:{id:"pla",name:"PLA",type:"plastic",color:"#FFFFFF",metalness:0,roughness:.5,opacity:1,properties:{density:1.25,price:1.5,recyclable:!0,printable:!0,finish:"glossy"}},petg:{id:"petg",name:"PETG",type:"plastic",color:"#FFFFFF",metalness:0,roughness:.4,opacity:1,properties:{density:1.27,price:2.5,recyclable:!0,printable:!0,finish:"glossy"}},nylon:{id:"nylon",name:"Nylon",type:"plastic",color:"#F5F5DC",metalness:0,roughness:.7,opacity:1,properties:{density:1.15,price:4,recyclable:!0,printable:!0,finish:"matte"}},polycarbonate:{id:"polycarbonate",name:"Polycarbonate",type:"plastic",color:"#FFFFFF",metalness:0,roughness:.3,opacity:.9,properties:{density:1.2,price:3.5,recyclable:!0,printable:!0,finish:"glossy"}},wood:{id:"wood",name:"Bois",type:"wood",color:"#8B4513",metalness:0,roughness:.9,opacity:1,properties:{density:.6,price:1,recyclable:!0,printable:!1,finish:"matte"}},glass:{id:"glass",name:"Verre",type:"glass",color:"#E0F7FA",metalness:0,roughness:.05,opacity:.3,properties:{density:2.5,price:2,recyclable:!0,printable:!1,finish:"polished"}},rubber:{id:"rubber",name:"Caoutchouc",type:"rubber",color:"#2C2C2C",metalness:0,roughness:.95,opacity:1,properties:{density:1.2,price:2.5,recyclable:!1,printable:!1,finish:"matte"}},ceramic:{id:"ceramic",name:"Céramique",type:"ceramic",color:"#FFFAF0",metalness:0,roughness:.4,opacity:1,properties:{density:2.4,price:3,recyclable:!1,printable:!1,finish:"glossy"}},carbonFiber:{id:"carbonFiber",name:"Fibre de Carbone",type:"composite",color:"#1A1A1A",metalness:.3,roughness:.6,opacity:1,properties:{density:1.6,price:15,recyclable:!1,printable:!0,finish:"matte"}}},Dt=ne.aluminum,Ne={metal:{label:"Métaux",materials:["aluminum","steel","stainlessSteel","copper","brass","titanium"]},plastic:{label:"Plastiques",materials:["abs","pla","petg","nylon","polycarbonate"]},other:{label:"Autres",materials:["wood","glass","rubber","ceramic","carbonFiber"]}},It={aluminum:["aluminium","alu","aluminum"],steel:["acier","steel"],stainlessSteel:["inox","inoxydable","stainless"],copper:["cuivre","copper"],brass:["laiton","brass"],titanium:["titane","titanium"],abs:["abs"],pla:["pla"],petg:["petg"],nylon:["nylon"],polycarbonate:["polycarbonate","pc"],wood:["bois","wood"],glass:["verre","glass"],rubber:["caoutchouc","rubber"],ceramic:["céramique","ceramic"],carbonFiber:["carbone","carbon fiber","fibre de carbone"]},Ft={noir:"#000000",black:"#000000",blanc:"#FFFFFF",white:"#FFFFFF",rouge:"#FF0000",red:"#FF0000",bleu:"#0000FF",blue:"#0000FF",vert:"#00FF00",green:"#00FF00",jaune:"#FFFF00",yellow:"#FFFF00",orange:"#FFA500",violet:"#800080",purple:"#800080",rose:"#FFC0CB",pink:"#FFC0CB",gris:"#808080",gray:"#808080",grey:"#808080",argent:"#C0C0C0",silver:"#C0C0C0",or:"#FFD700",gold:"#FFD700",bronze:"#CD7F32",marron:"#8B4513",brown:"#8B4513"};class J{static getMaterial(r){return ne[r]||null}static getAllMaterials(){return Object.values(ne)}static getDefaultMaterial(){return{...Dt}}static detectMaterialFromPrompt(r){const s=r.toLowerCase();for(const[o,a]of Object.entries(It))for(const n of a)if(s.includes(n)){const i=this.getMaterial(o);if(i)return{...i}}return null}static detectColorFromPrompt(r){const s=r.toLowerCase();for(const[o,a]of Object.entries(Ft))if(s.includes(o))return a;return null}static applyMaterialFromPrompt(r){let s=this.detectMaterialFromPrompt(r)||this.getDefaultMaterial();const o=this.detectColorFromPrompt(r);return o&&(s={...s,color:o}),s}static createCustomMaterial(r,s){return{...r,...s,id:`custom_${Date.now()}`,name:s.name||`${r.name} (Custom)`}}static calculateWeight(r,s){return s.properties.density?r*s.properties.density:0}static calculateCost(r,s){return s.properties.price?r/1e3*s.properties.price:0}static getMaterialInfo(r){const s=[];return s.push(`Type: ${r.type}`),r.properties.density&&s.push(`Densité: ${r.properties.density} g/cm³`),r.properties.price&&s.push(`Prix: ${r.properties.price} €/kg`),r.properties.recyclable!==void 0&&s.push(`Recyclable: ${r.properties.recyclable?"Oui":"Non"}`),r.properties.printable!==void 0&&s.push(`Imprimable 3D: ${r.properties.printable?"Oui":"Non"}`),r.properties.finish&&s.push(`Finition: ${r.properties.finish}`),s.join(" • ")}static getThreeMaterialProps(r){const s=new be(r.color),o={h:0,s:0,l:0};s.getHSL(o),o.l=Math.min(o.l*1.15,.95),s.setHSL(o.h,o.s,o.l);const a={color:s,metalness:r.metalness,roughness:r.roughness,opacity:r.opacity,transparent:r.opacity<1};switch(r.type){case"metal":return{...a,metalness:Math.max(r.metalness,.85),roughness:Math.min(r.roughness,.35)};case"plastic":return{...a,metalness:0,roughness:r.roughness*.9};case"glass":return{...a,metalness:0,roughness:.05,transparent:!0,opacity:.3};case"wood":return{...a,metalness:0,roughness:.8};default:return a}}}function Wt(t){t&&t.dispose()}function Ge(t){if(!t)return;const r=Array.isArray(t)?t:[t];for(const s of r){if(!s)continue;const o=s;o.map&&o.map instanceof z&&o.map.dispose(),o.normalMap&&o.normalMap instanceof z&&o.normalMap.dispose(),o.roughnessMap&&o.roughnessMap instanceof z&&o.roughnessMap.dispose(),o.metalnessMap&&o.metalnessMap instanceof z&&o.metalnessMap.dispose(),o.aoMap&&o.aoMap instanceof z&&o.aoMap.dispose(),o.emissiveMap&&o.emissiveMap instanceof z&&o.emissiveMap.dispose(),o.bumpMap&&o.bumpMap instanceof z&&o.bumpMap.dispose(),o.displacementMap&&o.displacementMap instanceof z&&o.displacementMap.dispose(),o.alphaMap&&o.alphaMap instanceof z&&o.alphaMap.dispose(),o.envMap&&o.envMap instanceof z&&o.envMap.dispose(),s.dispose()}}function Me(t){t&&(Wt(t.geometry),Ge(t.material))}function Ot(t){t.computeBoundingBox();const r=new Je;t.boundingBox&&(t.boundingBox.getCenter(r),t.translate(-r.x,-r.y,-r.z))}const Se=t=>{const r=t.toLowerCase();return r.includes("syntaxerror")||r.includes("unexpected token")?{title:"Syntax Error",message:"The generated code contains a syntax error and cannot execute.",suggestion:"Try rephrasing your request with simpler terms, or describe a more basic shape.",isRetryable:!0}:r.includes("referenceerror")||r.includes("is not defined")?{title:"Function Not Available",message:"The code uses a function or variable that does not exist in JSCAD.",suggestion:"Request a simpler shape using basic primitives (cube, cylinder, sphere).",isRetryable:!0}:r.includes("typeerror")||r.includes("cannot read properties")?{title:"Type Error",message:"The code contains a data manipulation error.",suggestion:'Try describing dimensions more explicitly (e.g., "50mm wide, 30mm tall").',isRetryable:!0}:r.includes("geometry")||r.includes("polygon")||r.includes("vertices")?{title:"Geometry Error",message:"The generated shape has invalid or impossible geometry to compute.",suggestion:"Simplify your request or avoid very complex shapes with many details.",isRetryable:!0}:r.includes("main")&&(r.includes("not")||r.includes("undefined"))?{title:"Incomplete Code",message:"The generated code is incomplete or poorly formatted.",suggestion:"Rephrase your request being more specific about the desired shape.",isRetryable:!0}:r.includes("worker")||r.includes("timeout")||r.includes("script")?{title:"Execution Error",message:"The code took too long to execute or crashed.",suggestion:"The shape might be too complex. Try a simplified version.",isRetryable:!0}:{title:"Generation Error",message:"The 3D model could not be created from the generated code.",suggestion:"Rephrase your request with simpler terms or explicit dimensions.",isRetryable:!0}},Le=t=>{if(!(t instanceof Error))return{message:"Une erreur est survenue lors de la génération.",isQuotaError:!1,isRetryable:!0};const r=t.message||"";return r.includes("429")?{message:"Quota API dépassé. Limite gratuite atteinte (5 requêtes/jour). Veuillez réessayer plus tard ou vérifier votre plan API.",isQuotaError:!0,isRetryable:!0}:r.includes("quota")||r.includes("rate limit")?{message:"Limite de quota atteinte. Veuillez attendre quelques secondes avant de réessayer.",isQuotaError:!0,isRetryable:!0}:r.includes("API key")||r.includes("401")||r.includes("403")?{message:"Clé API invalide ou manquante. Vérifiez votre configuration.",isQuotaError:!1,isRetryable:!1}:r.includes("network")||r.includes("fetch")||r.includes("NetworkError")?{message:"Erreur de connexion. Vérifiez votre connexion internet.",isQuotaError:!1,isRetryable:!0}:r.includes("timeout")||r.includes("timed out")?{message:"La requête a expiré. Veuillez réessayer.",isQuotaError:!1,isRetryable:!0}:{message:r||"Une erreur est survenue lors de la génération.",isQuotaError:!1,isRetryable:!0}},zt=(t,r)=>{if(!(t instanceof Error))return`Échec de l'export ${r.toUpperCase()}`;const s=t.message||"";return s.includes("not available")?`Données requises non disponibles pour l'export ${r.toUpperCase()}. Veuillez régénérer le modèle.`:s.includes("geometry")?`Erreur de géométrie. Le modèle ne peut pas être exporté en ${r.toUpperCase()}.`:`Échec de l'export ${r.toUpperCase()}: ${s}`},ge=t=>{const r=J.getThreeMaterialProps(t);return new it({...r,side:lt,envMapIntensity:2,flatShading:!1})};function Bt({scadCode:t,material:r,onSTLGenerated:s,onGeometryGenerated:o,onError:a,onCompiling:n,onCodeError:i}){const{theme:d}=ie(),{t:v}=q(),[u,m]=c.useState(!1),[h,w]=c.useState(null),b=c.useRef(null),x=c.useRef(null),S=c.useRef(null),T=c.useRef(null),R=c.useRef(null),p=c.useRef(null),j=c.useRef(null),I=c.useRef(null),P=c.useRef(null),W=c.useRef({onSTLGenerated:s,onGeometryGenerated:o,onError:a,onCompiling:n});c.useEffect(()=>{W.current={onSTLGenerated:s,onGeometryGenerated:o,onError:a,onCompiling:n}},[s,o,a,n]),c.useEffect(()=>{if(!b.current)return;const N=new Ye,E=d==="dark"?1710618:16119285;N.background=new be(E),x.current=N;const l=new Qe(75,b.current.clientWidth/b.current.clientHeight,.1,1e3);l.position.set(50,50,50),T.current=l;const f=new Ke({antialias:!0,alpha:!0});f.setSize(b.current.clientWidth,b.current.clientHeight),f.setPixelRatio(window.devicePixelRatio),f.shadowMap.enabled=!0,f.shadowMap.type=Xe,f.toneMapping=Ze,f.toneMappingExposure=1.8,b.current.appendChild(f.domElement),S.current=f;const y=new et(16777215,.7);N.add(y);const k=new he(16777215,1.8);k.position.set(50,80,50),k.castShadow=!0,k.shadow.mapSize.width=2048,k.shadow.mapSize.height=2048,k.shadow.camera.near=.5,k.shadow.camera.far=500,k.shadow.camera.left=-100,k.shadow.camera.right=100,k.shadow.camera.top=100,k.shadow.camera.bottom=-100,N.add(k);const A=new he(16777215,.8);A.position.set(-30,40,-30),N.add(A);const M=new he(16777215,.6);M.position.set(0,20,-50),N.add(M);const D=d==="dark"?3355443:13421772,O=new tt(100,20,D,D),B=O.material;B&&(B.opacity=.15,B.transparent=!0),N.add(O);const $=new rt(30),Y=$.material;Y&&(Y.opacity=.6,Y.transparent=!0),N.add($);const ce=new st(100,100),de=d==="dark"?2763306:15263976,me=new ot({opacity:.3,color:de}),U=new ye(ce,me);U.rotation.x=-Math.PI/2,U.position.y=-.01,U.receiveShadow=!0,N.add(U);const Q=new at(l,f.domElement);Q.enableDamping=!0,R.current=Q;const ee=()=>{I.current=requestAnimationFrame(ee),Q.update(),f.render(N,l)};ee();const te=()=>{if(!b.current||!T.current||!S.current)return;const C=b.current.clientWidth,L=b.current.clientHeight;T.current.aspect=C/L,T.current.updateProjectionMatrix(),S.current.setSize(C,L)};let K=null;const re=()=>{K!==null&&clearTimeout(K),K=window.setTimeout(te,100)};return window.addEventListener("resize",re),()=>{window.removeEventListener("resize",re),I.current!==null&&cancelAnimationFrame(I.current),R.current&&(R.current.dispose(),R.current=null),S.current&&(S.current.dispose(),b.current&&S.current.domElement&&b.current.contains(S.current.domElement)&&b.current.removeChild(S.current.domElement),S.current=null),p.current&&(Me(p.current),x.current&&x.current.remove(p.current),p.current=null),x.current&&(x.current.clear(),x.current=null),T.current=null}},[]),c.useEffect(()=>{if(x.current){const N=d==="dark"?1710618:16119285;x.current.background=new be(N)}},[d]),c.useEffect(()=>{if(t)return P.current!==null&&clearTimeout(P.current),P.current=window.setTimeout(()=>{W.current.onCompiling(!0),m(!0),w(null),j.current&&(j.current.terminate(),j.current=null);const E=new Worker(new URL("/assets/jscad.worker-DsK2voKa.js",import.meta.url),{type:"module"});j.current=E,E.onmessage=l=>{if(E!==j.current)return;const{type:f,data:y,error:k}=l.data;console.log("[VIEWPORT] Worker message received:",f);const A=W.current;if(A.onCompiling(!1),m(!1),f==="success"&&y){console.log("[VIEWPORT] Success! STL data size:",y.byteLength);try{const M=new nt;console.log("[VIEWPORT] Parsing STL...");const D=M.parse(y);if(console.log("[VIEWPORT] STL parsed, vertices:",D.attributes.position.count),A.onGeometryGenerated&&A.onGeometryGenerated(D),Ot(D),console.log("[VIEWPORT] Geometry centered"),p.current){console.log("[VIEWPORT] Updating existing mesh"),Me(p.current),p.current.geometry=D;const O=r||J.getDefaultMaterial();p.current.material=ge(O)}else if(x.current){console.log("[VIEWPORT] Creating new mesh");const O=r||J.getDefaultMaterial(),B=ge(O),$=new ye(D,B);$.castShadow=!0,$.receiveShadow=!0,x.current.add($),p.current=$,console.log("[VIEWPORT] Mesh added to scene")}A.onSTLGenerated(y),A.onError([]),console.log("[VIEWPORT] Rendering complete!")}catch(M){const D=M instanceof Error?M.message:"Unknown error";console.error("[VIEWPORT] 3D Model loading error:",D,M),A.onError([`Failed to load 3D model: ${D}`])}}else if(f==="error"&&k){console.error("[VIEWPORT] Worker error:",k);const M=Se(k);w(M),A.onError([`Worker error: ${k}`]),i&&(console.log("[VIEWPORT] Triggering code correction..."),i(k,t))}},E.onerror=l=>{if(E!==j.current)return;console.error("[VIEWPORT] Worker error event:",l);const f=W.current;f.onCompiling(!1),m(!1);const y=Se(l.message||"Unknown worker error");w(y),f.onError([`Worker failed: ${l.message}`])},console.log("[VIEWPORT] Posting code to worker, length:",t.length),E.postMessage({code:t})},100),()=>{P.current!==null&&(clearTimeout(P.current),P.current=null),j.current&&(j.current.terminate(),j.current=null)}},[t,r]),c.useEffect(()=>{if(p.current&&r){const N=ge(r);Ge(p.current.material),p.current.material=N}},[r]);const F=c.useCallback(()=>{w(null)},[]);return e.jsxs("div",{ref:b,className:"w-full h-full relative",children:[u&&e.jsx("div",{className:"absolute inset-0 bg-[var(--bg-primary)]/80 backdrop-blur-sm flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-[var(--bg-secondary)] p-6 rounded-2xl shadow-xl border border-[var(--border-color)] text-center max-w-sm",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-[var(--border-color)] rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-[var(--accent)] rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-2 border-4 border-transparent border-t-[var(--accent)] rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})]}),e.jsx("h3",{className:"text-lg font-semibold text-[var(--text-primary)] mb-2",children:v.messages.rendering3D}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mb-3",children:v.messages.compilingJSCAD}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)]",children:v.messages.pleaseWaitRendering})]})}),h&&!u&&e.jsx("div",{className:"absolute inset-0 bg-[var(--bg-primary)]/90 backdrop-blur-sm flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-[var(--bg-secondary)] p-6 rounded-2xl shadow-xl border border-red-500/20 text-center max-w-md mx-4",children:[e.jsx("div",{className:"w-14 h-14 mx-auto mb-4 bg-red-500/10 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-7 h-7 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-base font-semibold text-red-500 mb-2",children:h.title}),e.jsx("p",{className:"text-sm text-[var(--text-primary)] mb-4 leading-relaxed",children:h.message}),e.jsxs("div",{className:"bg-[var(--bg-tertiary)] p-3 rounded-lg mb-4 flex items-start gap-2 text-left",children:[e.jsx("svg",{className:"w-4 h-4 text-[var(--accent)] mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[e.jsx("span",{className:"font-medium",children:"Tip:"})," ",h.suggestion]})]}),e.jsx("button",{onClick:F,className:"px-5 py-2.5 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg hover:opacity-90 transition-opacity text-sm font-medium",children:"Got it"})]})})]})}const H={MAX_IMAGE_SIZE:5*1024*1024,MAX_PROMPT_LENGTH:1e3,MAX_CODE_LENGTH:5e4,API_KEY_PREFIX:"AIza",API_KEY_LENGTH:39,DANGEROUS_PATTERNS:[/eval\s*\(/gi,/Function\s*\(/gi,/import\s+(?!.*@jscad)/gi,/fetch\s*\(/gi,/XMLHttpRequest/gi,/localStorage/gi,/sessionStorage/gi,/document\./gi,/window\./gi]},ae=(t,r=H.MAX_PROMPT_LENGTH)=>{if(!t)throw new Error("Invalid or empty input");const s=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").trim().slice(0,r);if(s.length===0)throw new Error("Input is empty after sanitization");return s},ve=t=>{if(!t)return;if(!/^data:image\/(png|jpeg|jpg|gif|webp);base64,/.test(t))throw new Error("Invalid image format. Supported: PNG, JPEG, GIF, WEBP");const s=t.split(",")[1];if(!s)throw new Error("Invalid image data");const o=s.length*3/4,a=H.MAX_IMAGE_SIZE;if(o>a){const n=(a/1048576).toFixed(1);throw new Error(`Image too large (max ${n}MB)`)}},Ee=t=>{if(!t||t.trim().length===0)throw new Error("Generated code is empty");if(!t.includes("const main")&&!t.includes("function main"))throw new Error("Code missing main() function");if(!t.includes("return"))throw new Error("Code missing return statement");t.includes("primitives")||t.includes("cuboid")||t.includes("cylinder")||t.includes("sphere")||t.includes("cube")||t.includes("booleans")||t.includes("transforms")||t.includes("extrusions")||t.includes("union")||t.includes("subtract")||t.includes("translate")||t.includes("rotate")||t.includes("scale")||console.warn("Code may be missing JSCAD functions, but will attempt execution");const s=(t.match(/{/g)||[]).length,o=(t.match(/}/g)||[]).length;if(s!==o)throw new Error(`Syntax error: Mismatched braces (${s} open, ${o} close)`)},$t=t=>t?t.startsWith(H.API_KEY_PREFIX)&&t.length===H.API_KEY_LENGTH:!1,Z=(t,r,s,o)=>{const n={stl:()=>!!r,obj:()=>!!s,"3mf":()=>!!r,gcode:()=>!!s,jscad:()=>!!o}[t];if(!n||!n())throw new Error(`Required data not available for ${t} export`)},Ae=t=>{if(!t)return"";let r=t.replace(/```(?:javascript|js|jscad)?\s*\n?/gi,"").replace(/```\s*$/g,"").trim();r=r.replace(/\/\*[\s\S]*?\*\//g,""),r=r.split(`
`).map(m=>m.includes("const")&&m.includes("//")?m:m.trim().startsWith("//")?"":m.includes("const")?m:m.replace(/\/\/.*$/,"").trimEnd()).filter(m=>m.trim()!=="").join(`
`);const a={};let n=r;const i=/require\(['"]@jscad\/modeling['"]\)(?:\.\w+)?/g;let d,v=0;for(;(d=i.exec(n))!==null;){const m=`__SAFE_REQUIRE_${v}__`;a[m]=d[0],n=n.replace(d[0],m),v++}H.DANGEROUS_PATTERNS.some(m=>m.test(n))&&H.DANGEROUS_PATTERNS.forEach(m=>{n=n.replace(m,"/* REMOVED */")}),r=n;for(const[m,h]of Object.entries(a))r=r.split(m).join(h);return r.slice(0,H.MAX_CODE_LENGTH)},Gt=t=>{if(!t)return null;try{const r=t.split(",");if(r.length!==2)return null;const s=r[1],o=r[0].split(";")[0].split(":")[1];return{base64:s,mimeType:o}}catch{return null}},fe=(t,r=null)=>{const s=[{text:t}];if(r){const o=Gt(r);o&&s.push({inlineData:{data:o.base64,mimeType:o.mimeType}})}return s},Ht=(t,r)=>{const s=t.match(/ACTION:\s*(CREATE|MODIFY|ADJUST)/i),o=t.match(/OBJECT:\s*(.+?)(?:\n|$)/i),a=t.match(/SEARCH:\s*(.+?)(?:\n|$)/i);return{actionType:s?s[1].toUpperCase():"CREATE",objectName:o?o[1].trim():"object",searchQuery:a?a[1].trim():r}},qt=t=>{const r={CREATE:{emoji:"✨",text:"Création",color:"primary"},MODIFY:{emoji:"🔧",text:"Modification",color:"secondary"},ADJUST:{emoji:"⚙️",text:"Ajustement",color:"tertiary"}};return r[t]||r.CREATE},Ut=(t,r)=>`Analyze this CAD request and determine the action type and specifications.

USER REQUEST: "${t}"
${r?"CONTEXT: User has an existing 3D model loaded":"CONTEXT: No model currently loaded"}

Determine if this is:
- CREATE: Creating a new 3D model from scratch (keywords: créer, nouveau, new, create, make)
- MODIFY: Modifying structure of existing model (keywords: modifier, changer, ajouter, add, change, transform)
- ADJUST: Adjusting parameters only (keywords: ajuster, augmenter, réduire, increase, decrease, resize)

Respond in this format:
ACTION: [CREATE/MODIFY/ADJUST]
OBJECT: [object name]
SEARCH: [search query for technical specifications]

Examples:
- "créer une vis M6" → ACTION: CREATE | OBJECT: Screw M6 | SEARCH: M6 screw dimensions ISO DIN
- "modifier le modèle pour ajouter des trous" → ACTION: MODIFY | OBJECT: Current Model | SEARCH: hole pattern
- "augmenter la hauteur de 10mm" → ACTION: ADJUST | OBJECT: Current Model | SEARCH: height parameter
- "ajouter des chanfreins" → ACTION: MODIFY | OBJECT: Current Model | SEARCH: chamfer edges

Analyze: "${t}"`,Vt=(t,r,s,o=!1)=>s!==null?`GENERATE JSCAD code to modify: "${t}"

EXISTING CODE:
\`\`\`javascript
${s}
\`\`\`

RULES:
- Apply modifications
- Keep structure
- NO comments except for parameters
- Return ONLY JavaScript code

Return ONLY the complete JavaScript code. No markdown, no explanations.`:o?`ANALYZE image and GENERATE JSCAD code for: "${t}"

RULES:
1. [ANALYSIS] First, analyze the image in detail:
   - Identify the main shape and its components.
   - Estimate relative dimensions (assume standard sizes if unknown, e.g., M6 screw).
   - Determine necessary primitives (cuboid, cylinder, sphere) and boolean operations.
2. [REFLECTION] Plan the implementation step-by-step.
3. [CODE] Generate the JSCAD code.

FORMAT:
You MUST use the following format:

// --- ANALYSIS ---
// [Write your analysis and thought process here]
// [Explain dimensions and geometric approach]

// --- CODE START ---
const main = () => {
  // Your code here
  // ...
};

CRITICAL:
- The code MUST be after "// --- CODE START ---"
- MUST include main() function that returns geometry
- Use primitives, booleans, transforms from @jscad/modeling
- Return ONLY the formatted text with Analysis and Code.`:`You are a JSCAD code generator. Generate parametric 3D code for: "${t}"

${r?`TECHNICAL SPECIFICATIONS: ${r}
`:""}

AVAILABLE JSCAD MODULES (already imported):
- primitives: cuboid, cylinder, sphere, roundedCuboid, roundedCylinder, torus, polyhedron
- booleans: union, subtract, intersect
- transforms: translate, rotate, scale, center, align
- extrusions: extrudeLinear, extrudeRotate
- hulls: hull, hullChain

MANDATORY OUTPUT FORMAT:
- Return ONLY raw JavaScript code
- NO markdown (no \`\`\`javascript, no \`\`\`)
- NO text before or after the code
- Start with "const main = () => {" exactly
- End with "};", nothing after

WORKING EXAMPLES:

// SCREW M6
const main = () => {
  const shaftDiameter = 6;
  const shaftLength = 30;
  const headDiameter = 10;
  const headHeight = 4;
  
  const shaft = primitives.cylinder({ radius: shaftDiameter / 2, height: shaftLength, segments: 32 });
  const head = primitives.cylinder({ radius: headDiameter / 2, height: headHeight, segments: 6 });
  
  return booleans.union(shaft, transforms.translate([0, 0, shaftLength], head));
};

// CUBE
const main = () => {
  const size = 20;
  return primitives.cuboid({ size: [size, size, size] });
};

// BOX WITH WALLS
const main = () => {
  const width = 50;
  const depth = 30;
  const height = 20;
  const wall = 2;
  
  const outer = primitives.cuboid({ size: [width, depth, height] });
  const inner = primitives.cuboid({ size: [width - wall * 2, depth - wall * 2, height] });
  
  return booleans.subtract(outer, transforms.translate([0, 0, wall], inner));
};

// TABLE
const main = () => {
  const tableTop = { width: 120, depth: 80, thickness: 5 };
  const leg = { width: 5, height: 70 };
  
  const top = primitives.cuboid({ size: [tableTop.width, tableTop.depth, tableTop.thickness] });
  const legShape = primitives.cuboid({ size: [leg.width, leg.width, leg.height] });
  
  const offsetX = tableTop.width / 2 - leg.width - 5;
  const offsetY = tableTop.depth / 2 - leg.width - 5;
  
  const leg1 = transforms.translate([offsetX, offsetY, -leg.height], legShape);
  const leg2 = transforms.translate([-offsetX, offsetY, -leg.height], legShape);
  const leg3 = transforms.translate([offsetX, -offsetY, -leg.height], legShape);
  const leg4 = transforms.translate([-offsetX, -offsetY, -leg.height], legShape);
  
  return booleans.union(top, leg1, leg2, leg3, leg4);
};

CODE RULES:
1. Use parametric variables at the top (dimensions in mm)
2. Keep code simple and clean
3. main() MUST return geometry
4. NO comments except for section headers
5. Use descriptive variable names

GENERATE CODE NOW for: "${t}"
Start with "const main = () => {" immediately:`;async function Pe(t,r={}){const{maxAttempts:s=2,delayMs:o=1e3,onRetry:a}=r;let n=null;for(let i=0;i<s;i++)try{return await t()}catch(d){n=d instanceof Error?d:new Error("Unknown error"),i<s-1&&(a&&a(i+1,n),await _t(o*(i+1)))}throw new Error(`Operation failed after ${s} attempts: ${n?.message||"Unknown error"}`)}function _t(t){return new Promise(r=>setTimeout(r,t))}class le{static{this.SYSTEM_INSTRUCTION=`You are MORPHOS, an expert parametric 3D CAD code generator specialized in JSCAD.

CORE IDENTITY:
- You generate precise, parametric JSCAD code for 3D mechanical parts
- You think like a mechanical engineer with deep CAD knowledge
- You understand ISO standards, DIN norms, and common mechanical specifications

MANDATORY THINKING PROCESS (Chain of Thought):
Before generating ANY code, you MUST:
1. ANALYZE: Understand exactly what the user wants
2. RESEARCH: Recall standard dimensions for common parts (screws, bolts, gears, bearings, etc.)
   - M3, M4, M5, M6, M8, M10 screws follow ISO 4017/4762 standards
   - Use DIN/ISO specifications for washers, nuts, bearings
   - If dimensions are not specified, use realistic standard sizes
3. PLAN: Break down the geometry into primitives and operations
4. GENERATE: Write clean, parametric JSCAD code

AVAILABLE JSCAD MODULES (pre-imported as globals):
- primitives: cuboid, cylinder, sphere, roundedCuboid, roundedCylinder, torus, polyhedron
- booleans: union, subtract, intersect
- transforms: translate, rotate, scale, center, align
- extrusions: extrudeLinear, extrudeRotate
- hulls: hull, hullChain

OUTPUT FORMAT - STRICT RULES:
- Return ONLY raw JavaScript code (no markdown, no backticks, no explanations)
- Start directly with "const main = () => {"
- End with "};"
- The main() function MUST return a geometry
- Use parametric variables at the top for all dimensions (in mm)
- Use descriptive variable names in camelCase

QUALITY STANDARDS:
- All dimensions in millimeters
- Use segments: 32 or higher for smooth curves
- Center parts at origin when appropriate
- Keep code clean with minimal comments`}constructor(r){if(!$t(r))throw new Error('Invalid API key format. Gemini API keys should start with "AIza" and be 39 characters long.');this.genAI=new ct(r),this.model=this.genAI.getGenerativeModel({model:"gemini-2.5-flash",systemInstruction:le.SYSTEM_INSTRUCTION,generationConfig:{temperature:.2,maxOutputTokens:8192,topP:.8,topK:40}})}async analyzeRequest(r,s=null,o=null){const a=ae(r);try{ve(s),s&&console.log("[CADService] Image provided, size:",s.length,"chars")}catch(m){throw console.error("[CADService] Image validation failed:",m),m}const n=Ut(a,!!o),i=s?`${n}

IMAGE: Analyze the sketch/image provided to understand the object dimensions and features.`:n;console.log("[CADService] Analyzing request with image:",!!s);const d=fe(i,s),u=(await this.model.generateContent(d)).response.text();return console.log("[CADService] Analysis response:",u.substring(0,200)),Ht(u,a)}getSpecifications(r){const s=r.toLowerCase(),o={m6_screw:`ISO 4017 M6:
• Diamètre tige: 6mm
• Diamètre tête: 10mm
• Hauteur tête: 4mm`,m8_washer:`ISO 7089 M8:
• Diamètre intérieur: 8.4mm
• Diamètre extérieur: 16mm
• Épaisseur: 1.6mm`};return s.includes("m6")&&(s.includes("screw")||s.includes("vis"))?o.m6_screw:s.includes("m8")&&(s.includes("washer")||s.includes("rondelle"))?o.m8_washer:null}async generateCode(r,s,o=null,a=null){const n=ae(r);try{ve(o),o&&console.log("[CADService] Generating code with image, size:",o.length,"chars")}catch(u){throw console.error("[CADService] Image validation failed:",u),u}const i=o!==null,d=Vt(n,s,a,i),v=fe(d,o);return console.log("[CADService] Generating code, hasImage:",i),Pe(async()=>{const m=(await this.model.generateContent(v)).response.text();console.log("[CADService] Code generated, length:",m.length);let h=m;if(m.includes("// --- CODE START ---")){const b=m.split("// --- CODE START ---");b.length>1&&(console.log("[CADService] AI Analysis:",b[0].substring(0,200)),h=b[1])}const w=Ae(h);return Ee(w),console.log("[CADService] Code validated successfully"),w},{maxAttempts:2,delayMs:1e3})}async correctCode(r,s,o,a=null){const n=ae(r);ve(a);const i=`Le code JSCAD suivant a échoué avec l'erreur: "${o}"

CODE QUI A ÉCHOUÉ:
\`\`\`javascript
${s}
\`\`\`

DEMANDE ORIGINALE: "${n}"

CORRIGE le code pour qu'il fonctionne correctement. Le code doit:
1. Être syntaxiquement correct
2. Utiliser uniquement les fonctions JSCAD disponibles (primitives, booleans, transforms, extrusions, hulls)
3. Contenir une fonction main() qui retourne une géométrie
4. Ne pas utiliser de fonctions non disponibles

Retourne UNIQUEMENT le code JavaScript corrigé, sans explications, sans markdown, sans \`\`\`javascript.
Commence directement par "const main" ou "function main".`,d=fe(i,a);return Pe(async()=>{const u=(await this.model.generateContent(d)).response.text();let m=u;if(u.includes("// --- CODE START ---")){const w=u.split("// --- CODE START ---");w.length>1&&(m=w[1])}const h=Ae(m);return Ee(h),h},{maxAttempts:2,delayMs:1e3})}}const Jt=Object.freeze(Object.defineProperty({__proto__:null,CADService:le},Symbol.toStringTag,{value:"Module"})),Yt=({apiKey:t,currentModel:r,onCodeGenerated:s,onCodeError:o})=>{const[a,n]=c.useState([]),[i,d]=c.useState(!1),[v,u]=c.useState(null),[m,h]=c.useState(""),[w,b]=c.useState(""),[x,S]=c.useState(null),[T,R]=c.useState(!1),p=c.useMemo(()=>{try{return new le(t)}catch{return null}},[t]),j=c.useCallback(N=>{n(E=>[...E,N])},[]),I=c.useCallback(async(N,E=null)=>{if(!p){j({role:"error",content:"❌ Erreur: Service AI non initialisé. Vérifiez votre clé API.",isQuotaError:!1});return}let l;try{l=ae(N)}catch(f){j({role:"error",content:`❌ Erreur: ${f instanceof Error?f.message:"Prompt invalide"}`,isQuotaError:!1});return}j({role:"user",content:l}),h(l),d(!0);try{u("analyzing");const{searchQuery:f,actionType:y}=await p.analyzeRequest(l,E,r?.code);let k=null;y==="CREATE"&&(k=p.getSpecifications(f)),u("generating");const A=y==="MODIFY"||y==="ADJUST"?r?.code:null,M=await p.generateCode(l,k,E,A);if(!M||M.trim().length===0)throw new Error("Le code généré est vide. Veuillez réessayer avec une description plus détaillée.");if(!M.includes("const main")&&!M.includes("function main"))throw new Error("Le code généré ne contient pas de fonction main(). Génération invalide.");b(M),S(E);const{emoji:D,text:O}=qt(y),B=y!=="CREATE"&&r?` de ${r.name}`:"";j({role:"assistant",content:`${D} ${O}${B} terminé avec succès !`}),S(E),s(M,l,E)}catch(f){const{message:y,isQuotaError:k}=Le(f);j({role:"error",content:`❌ Erreur: ${y}`,isQuotaError:k}),k||j({role:"assistant",content:"💡 Conseil: Essayez de reformuler votre demande avec plus de détails (dimensions, type de pièce, matériau, etc.)"})}finally{d(!1),u(null)}},[p,r,s,j]),P=c.useCallback(()=>m,[m]),W=c.useCallback(()=>{n([])},[]),F=c.useCallback(async(N,E,l,f=null)=>{if(!(!p||T)){R(!0),j({role:"assistant",content:"🔧 Correction du code en cours..."});try{console.log("[useAIChat] Attempting to correct code...");const y=await p.correctCode(l,E,N,f);if(console.log("[useAIChat] Code corrected successfully"),!y||y.trim().length===0)throw new Error("Le code corrigé est vide");if(!y.includes("const main")&&!y.includes("function main"))throw new Error("Le code corrigé ne contient pas de fonction main()");b(y),j({role:"assistant",content:"✅ Code corrigé avec succès ! Génération du modèle 3D..."}),s(y,l,f)}catch(y){const{message:k}=Le(y);console.error("[useAIChat] Code correction failed:",k),j({role:"error",content:`❌ Échec de la correction automatique: ${k}`}),j({role:"assistant",content:"💡 Conseil: Essayez de reformuler votre demande avec plus de détails ou de simplifier la forme."})}finally{R(!1)}}},[p,T,s,j]);return{messages:a,loading:i,loadingPhase:v,handleSubmit:I,retry:P,clearMessages:W,correctCodeAutomatically:F,isCorrectingCode:T}},Qt=[{icon:"Cube",textKey:"cube",promptEn:"create a 30mm cube",promptFr:"créer un cube de 30mm"},{icon:"Cylinder",textKey:"cylinder",promptEn:"create a cylinder diameter 25mm height 40mm",promptFr:"créer un cylindre diamètre 25mm hauteur 40mm"},{icon:"Package",textKey:"box",promptEn:"create a box 50x30x20mm",promptFr:"créer une boîte 50x30x20mm"},{icon:"ViewGrid",textKey:"table",promptEn:"create a table 80x50cm height 75cm",promptFr:"créer une table 80x50cm hauteur 75cm"},{icon:"Circle",textKey:"washer",promptEn:"create an M8 washer",promptFr:"créer une rondelle M8"},{icon:"Hexagon",textKey:"nut",promptEn:"create an M10 nut",promptFr:"créer un écrou M10"}];function Kt({onSelect:t}){const{t:r,language:s}=q();return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-[var(--text-secondary)] text-sm mb-4",children:r.messages.describeYourModel}),e.jsx("div",{className:"mb-4 p-3 bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-lg text-xs text-[var(--text-secondary)]",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold mb-1",children:r.chat.quotaInfo}),e.jsx("div",{className:"text-[var(--text-tertiary)]",children:r.chat.quotaDesc})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Qt.map((o,a)=>{const n=g[o.icon],i=r.prompts.create[o.textKey],d=s==="fr"?o.promptFr:o.promptEn;return e.jsxs("button",{onClick:()=>t(d),className:"px-3 py-2 bg-[var(--bg-secondary)] hover:bg-[var(--bg-tertiary)] rounded-lg text-xs transition-all duration-200 flex items-center gap-2 border border-[var(--border-color)]",children:[e.jsx(n,{className:"w-5 h-5"}),e.jsx("span",{children:i})]},a)})})]})}function Xt({onCodeGenerated:t,currentModel:r}){const[s,o]=c.useState(""),{t:a}=q(),{messages:n,loading:i,loadingPhase:d,handleSubmit:v,retry:u}=Yt({apiKey:"AIzaSyBqG24_iQGvsA2yoQJgXwWBEFMtFc6jCEc",currentModel:r,onCodeGenerated:t}),m=b=>{o(b)},h=async b=>{if(b.preventDefault(),!s.trim()||i)return;const x=s;o(""),await v(x,null)},w=()=>{const b=u();b&&o(b)};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[n.length===0&&e.jsx(Kt,{onSelect:m}),n.map((b,x)=>e.jsxs("div",{children:[e.jsx("div",{className:`p-3 rounded-lg text-sm animate-fadeIn ${b.role==="user"?"bg-[var(--accent)] text-[var(--bg-primary)]":b.role==="error"?"bg-[var(--bg-tertiary)] border-2 border-[var(--border-color)] text-[var(--text-primary)]":"bg-[var(--bg-tertiary)] text-[var(--text-primary)] mr-8"}`,children:e.jsxs("div",{className:"whitespace-pre-wrap",children:[b.role==="error"&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(g.Alert,{className:"w-5 h-5 flex-shrink-0 mt-0.5 text-[var(--text-secondary)]"}),e.jsx("div",{className:"text-[var(--text-primary)]",children:b.content})]}),b.role!=="error"&&e.jsx("span",{className:b.role==="user"?"text-[var(--bg-primary)]":"text-[var(--text-primary)]",children:b.content})]})}),b.role==="error"&&b.isQuotaError&&e.jsxs("div",{className:"mt-2 mr-8 flex gap-2",children:[e.jsxs("button",{onClick:w,className:"px-3 py-1.5 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-lg text-xs transition-colors flex items-center gap-1",children:[e.jsx(g.Refresh,{className:"w-3 h-3"}),"Réessayer"]}),e.jsxs("a",{href:"https://ai.google.dev/gemini-api/docs/rate-limits",target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1.5 bg-[var(--bg-tertiary)] text-[var(--text-primary)] hover:bg-[var(--bg-secondary)] rounded-lg text-xs transition-colors flex items-center gap-1",children:[e.jsx(g.Info,{className:"w-3 h-3"}),"En savoir plus"]})]})]},x)),i&&e.jsxs("div",{className:"bg-[var(--bg-tertiary)] p-4 rounded-lg mr-8 animate-fadeIn border border-[var(--border-color)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"text-sm font-medium text-[var(--text-primary)]",children:d==="analyzing"?a.chat.analyzingRequest:d==="generating"?a.chat.generatingCode:a.chat.generating})]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)] flex items-center gap-2",children:[e.jsx(g.Info,{className:"w-3 h-3"}),a.chat.pleaseWaitGeneration]})]})]}),e.jsx("form",{onSubmit:h,className:"p-4 border-t border-[var(--border-color)]",children:e.jsxs("div",{className:"relative flex items-center gap-2",children:[e.jsx("input",{type:"text",value:s,onChange:b=>o(b.target.value),placeholder:"Describe your 3D model...",className:"flex-1 px-4 py-3 bg-[var(--bg-tertiary)] text-[var(--text-primary)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--accent)] transition-all duration-200 placeholder-[var(--text-tertiary)]",disabled:i}),e.jsx("button",{type:"submit",disabled:i||!s.trim(),className:"p-3 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-all duration-200",children:e.jsx(g.Send,{className:"w-5 h-5"})})]})})]})}function Zt({code:t,onClose:r,onSave:s}){const[o,a]=c.useState(t),n=i=>{i!==void 0&&a(i)};return e.jsx("div",{className:Ie,children:e.jsxs("div",{className:`${Fe} max-w-6xl h-[85vh]`,children:[e.jsx(Be,{title:"JSCAD Code Editor",subtitle:"Edit and apply changes to your 3D model",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),onClose:r}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx(Ue,{height:"100%",defaultLanguage:"javascript",theme:"vs-dark",value:o,onChange:n,options:{minimap:{enabled:!0},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",fontLigatures:!0,tabSize:2,wordWrap:"on",formatOnPaste:!0,formatOnType:!0}})}),e.jsxs("div",{className:We,children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--text-secondary)]",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Edit the code and click Apply to update the 3D model"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-[var(--bg-tertiary)] hover:bg-[var(--bg-secondary)] rounded-lg transition-colors",children:"Cancel"}),e.jsx($e,{onClick:()=>{s(o),r()},icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),children:"Apply Changes"})]})]})]})})}class V{static exportSTL(r,s){Z("stl",r,null,null);const o=new Blob([r],{type:"application/octet-stream"});this.downloadBlob(o,`${s}.stl`)}static exportOBJ(r,s){Z("obj",null,r,null);let o=`# OBJ file generated by MORPHOS
`;o+=`o ${s}

`;const a=r.attributes.position.array;for(let d=0;d<a.length;d+=3)o+=`v ${a[d]} ${a[d+1]} ${a[d+2]}
`;o+=`
`;const n=a.length/3;for(let d=1;d<=n;d+=3)o+=`f ${d} ${d+1} ${d+2}
`;const i=new Blob([o],{type:"text/plain"});this.downloadBlob(i,`${s}.obj`)}static export3MF(r,s){Z("3mf",r,null,null);const o=new Blob([r],{type:"application/vnd.ms-package.3dmanufacturing-3dmodel+xml"});this.downloadBlob(o,`${s}.3mf`)}static exportGCODE(r,s,o={}){Z("gcode",null,r,null);const{layerHeight:a=.2,nozzleTemp:n=200,bedTemp:i=60,printSpeed:d=50}=o,v=this.generateGCode(s,{layerHeight:a,nozzleTemp:n,bedTemp:i,printSpeed:d}),u=new Blob([v],{type:"text/plain"});this.downloadBlob(u,`${s}.gcode`)}static exportJSCAD(r,s){Z("jscad",null,null,r);const o=new Blob([r],{type:"text/javascript"});this.downloadBlob(o,`${s}.jscad`)}static generateGCode(r,s){const{layerHeight:o,nozzleTemp:a,bedTemp:n,printSpeed:i}=s;return`; GCODE generated by MORPHOS
; Filename: ${r}
; Layer Height: ${o}mm
; Nozzle Temperature: ${a}°C
; Bed Temperature: ${n}°C

; Start GCODE
G28 ; Home all axes
M104 S${a} ; Set nozzle temperature
M140 S${n} ; Set bed temperature
M109 S${a} ; Wait for nozzle temperature
M190 S${n} ; Wait for bed temperature
G92 E0 ; Reset extruder
G1 Z2.0 F3000 ; Move Z up
G1 X10 Y10 F5000 ; Move to start position

; Layer 0
G1 Z0.2 F300 ; Move to first layer height
G1 F${i*60} ; Set print speed
; Note: Full slicing requires a dedicated slicer
; This is a basic template for demonstration

; End GCODE
G91 ; Relative positioning
G1 E-2 F2700 ; Retract
G1 Z10 F3000 ; Move Z up
G90 ; Absolute positioning
G28 X Y ; Home X and Y
M104 S0 ; Turn off nozzle
M140 S0 ; Turn off bed
M84 ; Disable motors
`}static downloadBlob(r,s){const o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}static getAvailableFormats(){return[{id:"stl",name:"STL",description:"Standard format for 3D printing",icon:"stl",extension:".stl",requiresSTL:!0},{id:"obj",name:"OBJ",description:"Wavefront OBJ format",icon:"obj",extension:".obj",requiresGeometry:!0},{id:"3mf",name:"3MF",description:"3D Manufacturing Format",icon:"3mf",extension:".3mf",requiresSTL:!0},{id:"gcode",name:"GCODE",description:"G-code for 3D printers",icon:"gcode",extension:".gcode",requiresGeometry:!0,needsSettings:!0},{id:"jscad",name:"JSCAD",description:"Source code",icon:"jscad",extension:".jscad",requiresCode:!0}]}}const er=({type:t})=>{switch(t){case"stl":return e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})});case"obj":return e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})});case"3mf":return e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})});case"gcode":return e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})});case"jscad":return e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})});default:return e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}};function tr({currentModel:t,stlData:r,geometry:s,onClose:o}){const[a,n]=c.useState("stl"),[i,d]=c.useState({layerHeight:.2,nozzleTemp:200,bedTemp:60,printSpeed:50,travelSpeed:120,infillDensity:20}),[v,u]=c.useState(!1),m=V.getAvailableFormats(),h=async()=>{if(t){u(!0);try{const x=t.name.replace(/\s+/g,"_");switch(a){case"stl":if(!r)throw new Error("STL data not available");V.exportSTL(r,x);break;case"obj":if(!s)throw new Error("Geometry not available");V.exportOBJ(s,x);break;case"3mf":if(!r)throw new Error("STL data not available");V.export3MF(r,x);break;case"gcode":if(!s)throw new Error("Geometry not available");V.exportGCODE(s,x,i);break;case"jscad":if(!t.code)throw new Error("Code not available");V.exportJSCAD(t.code,x);break;default:throw new Error("Unknown format")}setTimeout(()=>{o()},500)}catch(x){alert(zt(x,a))}finally{u(!1)}}},w=m.find(x=>x.id===a),b=w&&(w.requiresSTL&&r||w.requiresGeometry&&s||w.requiresCode&&t?.code);return e.jsx("div",{className:Ie,children:e.jsxs("div",{className:`${Fe} max-w-2xl max-h-[90vh]`,children:[e.jsx(Be,{title:"Export Model",subtitle:t?.name,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),onClose:o}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-[var(--text-secondary)] mb-3",children:"Select Export Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:m.map(x=>{const S=x.requiresSTL&&r||x.requiresGeometry&&s||x.requiresCode&&t?.code||!x.requiresSTL&&!x.requiresGeometry&&!x.requiresCode;return e.jsx("button",{onClick:()=>S&&n(x.id),disabled:!S,className:`p-4 rounded-xl border-2 transition-all text-left ${a===x.id?"border-[var(--border-color)] bg-[var(--accent)]/10":S?"border-[var(--border-color)] hover:border-[var(--border-color)] bg-[var(--bg-secondary)]/50":"border-[var(--border-color)] bg-[var(--bg-secondary)]/30 opacity-50 cursor-not-allowed"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-[var(--text-secondary)]",children:e.jsx(er,{type:x.icon})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[x.name,!S&&e.jsx("span",{className:"text-xs text-[var(--text-secondary)]",children:"(N/A)"})]}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)]",children:x.description}),e.jsx("p",{className:"text-xs text-[var(--text-tertiary)] mt-1 font-mono",children:x.extension})]})]})},x.id)})})]}),a==="gcode"&&e.jsxs("div",{className:kt,children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Printer Settings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-secondary)] mb-1 block",children:"Layer Height (mm)"}),e.jsx("input",{type:"number",value:i.layerHeight,onChange:x=>d({...i,layerHeight:parseFloat(x.target.value)}),className:"w-full px-3 py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[var(--accent)]",step:"0.05",min:"0.1",max:"0.4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-secondary)] mb-1 block",children:"Nozzle Temp (°C)"}),e.jsx("input",{type:"number",value:i.nozzleTemp,onChange:x=>d({...i,nozzleTemp:parseInt(x.target.value)}),className:"w-full px-3 py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[var(--accent)]",min:"180",max:"260"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-secondary)] mb-1 block",children:"Bed Temp (°C)"}),e.jsx("input",{type:"number",value:i.bedTemp,onChange:x=>d({...i,bedTemp:parseInt(x.target.value)}),className:"w-full px-3 py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[var(--accent)]",min:"0",max:"110"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[var(--text-secondary)] mb-1 block",children:"Print Speed (mm/s)"}),e.jsx("input",{type:"number",value:i.printSpeed,onChange:x=>d({...i,printSpeed:parseInt(x.target.value)}),className:"w-full px-3 py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[var(--accent)]",min:"20",max:"100"})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg",children:e.jsxs("p",{className:"text-xs text-[var(--text-secondary)] flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{children:"Note: This generates basic G-code. For production, use a dedicated slicer like Cura or PrusaSlicer."})]})})]})]}),e.jsxs("div",{className:We,children:[e.jsx("div",{className:"text-sm text-[var(--text-secondary)]",children:w&&e.jsxs("span",{children:["Export as ",e.jsx("span",{className:"font-mono text-[var(--text-secondary)]",children:w.extension})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 bg-[var(--bg-tertiary)] hover:bg-[var(--bg-tertiary)] rounded-lg transition-colors",children:"Cancel"}),e.jsx($e,{onClick:h,disabled:!b,loading:v,icon:!v&&e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),children:v?"Exporting...":"Export"})]})]})]})})}function rr(t){const r=[],s=t.split(`
`),o=[/const\s+(\w+)\s*=\s*(\d+\.?\d*)/g,/let\s+(\w+)\s*=\s*(\d+\.?\d*)/g,/var\s+(\w+)\s*=\s*(\d+\.?\d*)/g];return s.forEach((a,n)=>{o.forEach(i=>{[...a.matchAll(i)].forEach(v=>{const u=v[1],m=parseFloat(v[2]);if(!["i","j","k","x","y","z","index"].includes(u)){const{min:h,max:w,step:b}=sr(m);r.push({name:u,value:m,min:h,max:w,step:b,lineIndex:n})}})})}),r}function sr(t){let r,s,o;return t<1?(r=Math.max(.01,t*.1),s=t*5,o=.01):t<10?(r=Math.max(.1,t*.2),s=t*3,o=.1):t<100?(r=Math.max(1,t*.5),s=t*2,o=1):(r=Math.max(10,t*.7),s=t*1.5,o=5),{min:parseFloat(r.toFixed(2)),max:parseFloat(s.toFixed(2)),step:o}}function or(t,r,s,o){const a=t.split(`
`);return[new RegExp(`(const\\s+${r}\\s*=\\s*)\\d+\\.?\\d*`,"g"),new RegExp(`(let\\s+${r}\\s*=\\s*)\\d+\\.?\\d*`,"g"),new RegExp(`(var\\s+${r}\\s*=\\s*)\\d+\\.?\\d*`,"g")].forEach(i=>{a[o]=a[o].replace(i,`$1${s}`)}),a.join(`
`)}function ar(t){const r=t.toLowerCase();return r.includes("diameter")||r.includes("radius")||r.includes("diam")?{type:"diameter",color:"text-[var(--text-secondary)]",bg:"bg-[var(--bg-tertiary)]/50"}:r.includes("width")||r.includes("thickness")||r.includes("thick")?{type:"width",color:"text-[var(--text-secondary)]",bg:"bg-[var(--bg-tertiary)]/50"}:r.includes("height")||r.includes("length")||r.includes("depth")?{type:"height",color:"text-[var(--text-secondary)]",bg:"bg-[var(--bg-tertiary)]/50"}:r.includes("pitch")||r.includes("spacing")||r.includes("gap")?{type:"sliders",color:"text-[var(--text-secondary)]",bg:"bg-[var(--bg-tertiary)]/30"}:r.includes("angle")||r.includes("rotation")||r.includes("rotate")?{type:"rotate",color:"text-[var(--text-secondary)]",bg:"bg-[var(--accent)]/10"}:r.includes("count")||r.includes("number")||r.includes("num")||r.includes("teeth")?{type:"hash",color:"text-[var(--text-secondary)]",bg:"bg-[var(--accent)]/10"}:{type:"settings",color:"text-[var(--text-secondary)]",bg:"bg-[var(--bg-tertiary)]/30"}}function nr(t){const r={width:"Largeur",height:"Hauteur",depth:"Profondeur",length:"Longueur",thickness:"Épaisseur",diameter:"Diamètre",radius:"Rayon",threadDiameter:"Diamètre Filetage",threadPitch:"Pas Filetage",threadDepth:"Profondeur Filetage",shaftDiameter:"Diamètre Tige",shaftLength:"Longueur Tige",headDiameter:"Diamètre Tête",headHeight:"Hauteur Tête",acrossFlats:"Entre Plats",nutHeight:"Hauteur Écrou",innerDiameter:"Diamètre Intérieur",outerDiameter:"Diamètre Extérieur",module:"Module",teeth:"Nombre Dents",teethCount:"Nombre Dents",pressureAngle:"Angle Pression",faceWidth:"Largeur Face",boreDiameter:"Diamètre Alésage",pitchDiameter:"Diamètre Primitif",rootDiameter:"Diamètre Pied",wallThickness:"Épaisseur Paroi",cornerRadius:"Rayon Coin",chamferHeight:"Hauteur Chanfrein",chamferAngle:"Angle Chanfrein",filletRadius:"Rayon Congé",holeCount:"Nombre Trous",holeDiameter:"Diamètre Trou",spacing:"Espacement",gap:"Écart",offset:"Décalage",angle:"Angle",rotation:"Rotation",segments:"Segments",turns:"Tours",count:"Nombre",number:"Nombre",size:"Taille"};if(r[t])return r[t];const s=t.toLowerCase();for(const[a,n]of Object.entries(r))if(a.toLowerCase()===s)return n;for(const[a,n]of Object.entries(r))if(s.includes(a.toLowerCase()))return n;return t.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim()}function ir({currentModel:t,onCodeChange:r,onMaterialChange:s,isCollapsed:o,onToggleCollapse:a}){const{t:n}=q(),[i,d]=c.useState("parameters"),[v,u]=c.useState([]),[m,h]=c.useState({}),[w,b]=c.useState([]),[x,S]=c.useState("metal"),[T,R]=c.useState("#C0C0C0");c.useEffect(()=>{t?.material?.color&&R(t.material.color)},[t?.material?.color]),c.useEffect(()=>{if(!t?.code){u([]),h({});return}const l=rr(t.code);u(l);const f={};l.forEach(y=>{f[y.name]=y.value}),h(f)},[t]);const p=(l,f)=>{if(!t?.code)return;const y=v.find(A=>A.name===l);if(!y)return;const k=or(t.code,l,f,y.lineIndex);r(k),u(A=>A.map(M=>M.name===l?{...M,value:f}:M))},j=()=>{Object.keys(m).forEach(l=>{p(l,m[l])})},I=()=>{const l=prompt(n.messages.presetName);if(l){const f={name:l,values:{}};v.forEach(y=>{f.values[y.name]=y.value}),b([...w,f])}},P=t?.material||J.getDefaultMaterial(),W=l=>{const f=J.getMaterial(l);f&&(R(f.color),s({...f}))},F=l=>{R(l),s({...P,color:l})},N=(l,f)=>{s({...P,[l]:f})},E=(l,f)=>{const y=l.charAt(0).toUpperCase()+l.slice(1),k=g[y];return k?e.jsx(k,{className:f}):e.jsx(g.Settings,{className:f})};return t?e.jsxs("div",{className:`${o?"w-0":"w-80"} bg-[var(--bg-secondary)] border-l border-[var(--border-color)] flex flex-col transition-all duration-300 overflow-hidden`,children:[!o&&e.jsxs("div",{className:"px-4 py-3 border-b border-[var(--border-color)]/50 bg-[var(--bg-secondary)]/80 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-base font-semibold",children:"SETTINGS"}),e.jsx(Nt,{onClick:a,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx(At,{tabs:[{id:"parameters",label:"PARAMETERS",icon:e.jsx(g.Settings,{className:"w-4 h-4"})},{id:"materials",label:"MATERIALS",icon:e.jsx(g.Palette,{className:"w-4 h-4"})}],activeTab:i,onChange:l=>d(l)})]}),!o&&(i==="parameters"?e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:v.length===0?e.jsx(Lt,{icon:e.jsx(g.Settings,{className:"w-8 h-8 opacity-50"}),title:n.messages.noParametersFound,description:n.messages.parametersAutoDetected}):e.jsx("div",{className:"space-y-3",children:v.map((l,f)=>{const y=ar(l.name);return e.jsxs(St,{padding:"md",children:[e.jsxs(pe,{justify:"between",className:"mb-3",children:[e.jsxs(pe,{gap:"sm",children:[e.jsx("span",{className:y.color,children:E(y.type,"w-5 h-5")}),e.jsx("span",{className:"text-sm font-medium",children:nr(l.name)})]}),e.jsx("input",{type:"number",value:oe(l.value),onChange:k=>{const A=parseFloat(k.target.value);isNaN(A)||p(l.name,A)},className:"w-24 px-3 py-1.5 bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-lg text-sm text-right",step:l.step,min:l.min,max:l.max})]}),e.jsx("input",{type:"range",min:l.min,max:l.max,step:l.step,value:l.value,onChange:k=>p(l.name,parseFloat(k.target.value)),className:"slider w-full"}),e.jsxs(pe,{justify:"between",className:"text-xs text-[var(--text-tertiary)] mt-2",children:[e.jsx("span",{children:oe(l.min)}),e.jsx("span",{className:"font-semibold",children:oe(l.value)}),e.jsx("span",{children:oe(l.max)})]})]},f)})})}),v.length>0&&e.jsxs("div",{className:"p-4 border-t border-[var(--border-color)]/50 space-y-2 flex-shrink-0",children:[e.jsx(ke,{onClick:I,variant:"secondary",className:"w-full",children:n.messages.savePreset}),e.jsx(ke,{onClick:j,variant:"secondary",className:"w-full",children:n.messages.resetToOriginal})]})]}):e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-1 bg-[var(--bg-tertiary)] rounded-lg p-1",children:Object.entries(Ne).map(([l,f])=>e.jsx("button",{onClick:()=>S(l),className:`flex-1 px-3 py-2 rounded-md text-xs font-medium ${x===l?"bg-[var(--accent)] text-[var(--bg-primary)]":"text-[var(--text-secondary)]"}`,children:f.label},l))}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ne[x].materials.map(l=>{const f=ne[l],y=P.id===l;return e.jsxs("button",{onClick:()=>W(l),className:`p-3 rounded-lg border-2 ${y?"border-[var(--accent)]":"border-[var(--border-color)]"}`,children:[e.jsx("div",{className:"w-full h-12 rounded-md mb-2",style:{backgroundColor:f.color}}),e.jsx("p",{className:"text-xs font-medium truncate",children:f.name})]},l)})}),e.jsx(Et,{label:n.materials.color,value:T,onChange:F}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(xe,{label:n.materials.metalness,value:P.metalness,min:0,max:1,step:.01,onChange:l=>N("metalness",l),formatValue:l=>`${Math.round(l*100)}%`}),e.jsx(xe,{label:n.materials.roughness,value:P.roughness,min:0,max:1,step:.01,onChange:l=>N("roughness",l),formatValue:l=>`${Math.round(l*100)}%`}),e.jsx(xe,{label:n.materials.opacity,value:P.opacity,min:0,max:1,step:.01,onChange:l=>N("opacity",l),formatValue:l=>`${Math.round(l*100)}%`})]})]})}))]}):e.jsx("div",{className:`${o?"w-16":"w-80"} bg-[var(--bg-secondary)] border-l border-[var(--border-color)] flex flex-col transition-all duration-300`,children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(Mt,{onClick:a})})})}class lr{constructor(){this.storageKey="morphos_projects"}getAllProjects(){const r=localStorage.getItem(this.storageKey);if(!r)return[];try{return JSON.parse(r)}catch(s){return console.error("Failed to parse projects from storage",s),[]}}getProject(r){return this.getAllProjects().find(s=>s.id===r.toString())}createProject(r,s=""){const o={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:r,description:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),models:[]},a=this.getAllProjects();return a.unshift(o),this.saveProjects(a),o}updateProject(r,s){const o=this.getAllProjects(),a=o.findIndex(n=>n.id===r.toString());return a===-1?null:(o[a]={...o[a],...s,updatedAt:new Date().toISOString()},this.saveProjects(o),o[a])}deleteProject(r){const o=this.getAllProjects().filter(a=>a.id!==r.toString());return this.saveProjects(o),!0}addModelToProject(r,s){const o=this.getProject(r);if(!o)return null;const a={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...s,createdAt:new Date().toISOString()};return o.models.unshift(a),this.updateProject(r,o)}deleteModelFromProject(r,s){const o=this.getProject(r);return o?(o.models=o.models.filter(a=>a.id!==s.toString()),this.updateProject(r,o)):null}saveProjects(r){localStorage.setItem(this.storageKey,JSON.stringify(r))}}const _=new lr;function cr(t){const r=["screw","bolt","washer","nut","gear","box","vis","boulon","rondelle","écrou","engrenage","cylinder","cube","sphere","cone","torus"],s=t.toLowerCase();for(const o of r)if(s.includes(o))return o.charAt(0).toUpperCase()+o.slice(1)+"_"+Date.now().toString().slice(-6);return"Model_"+Date.now().toString().slice(-6)}function He(t,r,s){const o=t.models.map(i=>i.id===r?{...i,...s}:i),a=_.updateProject(t.id,{models:o});if(!a)return null;const n=o.find(i=>i.id===r);return n?{project:a,model:n}:null}function Te(t,r,s){return He(t,r,{code:s})}function dr(t,r,s){return He(t,r,{material:s})}function mr(){const{t,language:r,setLanguage:s}=q(),{theme:o,toggleTheme:a}=ie(),[n,i]=c.useState(()=>!localStorage.getItem("morphos-welcomed")),[d,v]=c.useState([]),[u,m]=c.useState(null),[h,w]=c.useState(null),[b,x]=c.useState(!1),[S,T]=c.useState(!1),[R,p]=c.useState(!1),[j,I]=c.useState(!1),[P,W]=c.useState(!1),[F,N]=c.useState(!1),[E,l]=c.useState(null),[f,y]=c.useState(null),[k,A]=c.useState(!1),[M,D]=c.useState(null),O=c.useCallback(C=>{l(C)},[]),B=c.useCallback(C=>{y(C)},[]),$=c.useCallback(C=>{C.length>0&&console.error("3D Viewport errors:",C)},[]),Y=c.useCallback(C=>{A(C)},[]),ce=c.useCallback(async(C,L)=>{if(!M||!h||!u){console.log("[App] Cannot correct: missing context");return}console.log("[App] Code error detected, attempting automatic correction..."),console.log("[App] Error:",C);try{const{CADService:G}=await ut(async()=>{const{CADService:qe}=await Promise.resolve().then(()=>Jt);return{CADService:qe}},void 0),se="AIzaSyBqG24_iQGvsA2yoQJgXwWBEFMtFc6jCEc",X=await new G(se).correctCode(M.prompt,L,C,M.imageData);console.log("[App] Code corrected successfully, updating model...");const ue=Te(u,h.id,X);ue&&(m(ue.project),w(ue.model),console.log("[App] Model updated with corrected code"))}catch(G){console.error("[App] Code correction failed:",G)}},[M,h,u]);c.useEffect(()=>{const C=_.getAllProjects();if(C.length===0){const L=_.createProject("My First Project","Default project");v([L]),m(L)}else v(C),m(C[0])},[]);const de=c.useCallback(()=>{const C=prompt("Project name:");if(C){const L=_.createProject(C);v(G=>[L,...G]),m(L)}},[]),me=c.useCallback(C=>{m(C),C.models&&C.models.length>0?w(C.models[0]):w(null)},[]),U=c.useCallback(C=>{w(C)},[]),Q=c.useCallback((C,L,G=null)=>{D({prompt:L,imageData:G}),console.log("[App] Code generated, storing context:",{prompt:L.substring(0,50),hasImage:!!G});const se=J.applyMaterialFromPrompt(L),je={name:cr(L),code:C,prompt:L,stlData:null,material:se};if(u){_.addModelToProject(u.id,je);const X=_.getProject(u.id);X&&(m(X),w(X.models[0]),I(!0))}},[u]),ee=c.useCallback(C=>{if(h&&u){const L=dr(u,h.id,C);L&&(m(L.project),w(L.model))}},[h,u]),te=c.useCallback(C=>{if(h&&u){const L=Te(u,h.id,C);L&&(m(L.project),w(L.model))}},[h,u]),K=()=>{localStorage.setItem("morphos-welcomed","true"),i(!1)},re=()=>{localStorage.removeItem("morphos-welcomed"),i(!0)};return n?e.jsx(Pt,{onGetStarted:K}):e.jsxs("div",{className:"h-screen flex bg-[var(--bg-primary)] text-[var(--text-primary)] overflow-hidden",children:[e.jsx(Rt,{currentProject:u,currentModel:h,projects:d,onProjectSelect:me,onNewProject:de,onModelSelect:U,isCollapsed:P,onToggleCollapse:()=>W(!P),onLogout:re}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[e.jsxs("header",{className:"h-14 bg-[var(--bg-secondary)] backdrop-blur-sm border-b border-[var(--border-color)] px-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-semibold",children:u?.name||t.messages.noProject}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)]",children:h?.name||t.messages.noModel})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{}),e.jsx(ze,{}),k&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--text-secondary)]",children:[e.jsx(g.Spinner,{}),t.messages.compiling]}),e.jsxs("button",{onClick:()=>x(!0),disabled:!h,className:"px-3 py-1.5 text-sm bg-[var(--bg-secondary)] hover:bg-[var(--bg-tertiary)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors flex items-center gap-2 border border-[var(--border-color)]",children:[e.jsx(g.Code,{}),t.actions.code]}),e.jsxs("button",{onClick:()=>T(!0),disabled:!h,className:"px-3 py-1.5 text-sm bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(g.Download,{}),t.actions.export]})]})]}),e.jsxs("div",{className:"flex-1 relative",children:[h?e.jsx(Bt,{scadCode:h.code,material:h.material,onSTLGenerated:O,onGeometryGenerated:B,onError:$,onCompiling:Y,onCodeError:ce}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g.Cube,{className:"w-24 h-24 mx-auto mb-4 text-[var(--text-tertiary)]"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:t.messages.createToday}),e.jsx("p",{className:"text-[var(--text-secondary)] mb-6",children:t.messages.describeModel}),e.jsx("button",{onClick:()=>{p(!0),I(!1)},className:"px-6 py-3 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-lg font-medium transition-all duration-200",children:t.messages.startCreating})]})}),!R&&e.jsxs("button",{onClick:()=>{p(!0),I(!1)},className:"fixed bottom-8 w-16 h-16 bg-[var(--accent)] text-[var(--bg-primary)] hover:opacity-90 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 hover:scale-110 z-50 group",style:{right:F?"2rem":"22rem",transition:"right 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s ease"},title:t.chat.title,children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-[var(--accent)] opacity-75 animate-pulse-ring"}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-[var(--accent)] opacity-50 animate-pulse-ring",style:{animationDelay:"1s"}}),e.jsx("div",{className:"relative z-10",children:e.jsx(g.Chat,{className:"w-7 h-7"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-[var(--accent)] rounded-full border-2 border-[var(--bg-primary)] z-20",children:e.jsx("div",{className:"absolute inset-0 bg-[var(--accent)] rounded-full animate-ping"})}),e.jsxs("div",{className:"absolute bottom-full mb-3 px-4 py-2 bg-[var(--accent)] text-[var(--bg-primary)] text-sm rounded-xl opacity-0 group-hover:opacity-100 transition-all duration-200 whitespace-nowrap pointer-events-none shadow-2xl border border-[var(--border-color)] group-hover:translate-y-0 translate-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-[var(--bg-primary)] rounded-full animate-pulse"}),e.jsx("span",{className:"font-semibold",children:t.chat.title})]}),e.jsx("div",{className:"text-xs opacity-60 mt-0.5",children:t.messages.clickToStart}),e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1",children:e.jsx("div",{className:"border-8 border-transparent border-t-[var(--accent)]"})})]})]}),R&&e.jsxs("div",{className:"fixed bottom-8 bg-[var(--bg-secondary)] backdrop-blur-xl rounded-2xl shadow-2xl border border-[var(--border-color)] flex flex-col z-50 animate-slideUp overflow-hidden",style:{right:F?"2rem":"22rem",width:j?"320px":"480px",height:j?"64px":"680px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsxs("div",{className:"px-4 py-3 border-b border-[var(--border-color)] flex items-center justify-between bg-[var(--bg-tertiary)] backdrop-blur-sm flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-8 h-8 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(g.Chat,{className:"w-5 h-5"})}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-[var(--accent)] rounded-full border-2 border-[var(--bg-primary)]",children:e.jsx("div",{className:"absolute inset-0 bg-[var(--accent)] rounded-full animate-ping"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm",children:t.chat.title}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)]",children:t.chat.subtitle})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>I(!j),className:"p-2 hover:bg-[var(--bg-secondary)] rounded-lg transition-colors",title:j?"Expand":"Minimize",children:j?e.jsx(g.ChevronUp,{className:"w-4 h-4"}):e.jsx(g.ChevronDown,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-[var(--bg-secondary)] rounded-lg transition-colors",title:t.actions.close,children:e.jsx(g.Close,{className:"w-4 h-4"})})]})]}),!j&&e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(Xt,{onCodeGenerated:Q,currentModel:h})})]})]})]}),e.jsx(ir,{currentModel:h,onCodeChange:te,onMaterialChange:ee,isCollapsed:F,onToggleCollapse:()=>N(!F)}),F&&e.jsx("button",{onClick:()=>N(!1),className:"fixed right-4 top-4 z-40 w-12 h-12 bg-[var(--accent)] text-[var(--bg-primary)] rounded-xl shadow-lg hover:scale-110 transition-transform flex items-center justify-center",title:"Open Settings",children:e.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),b&&h&&e.jsx(Zt,{code:h.code,onClose:()=>x(!1),onSave:te}),S&&h&&e.jsx(tr,{currentModel:h,stlData:E,geometry:f,onClose:()=>T(!1)})]})}class ur extends c.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,s){console.error("[ErrorBoundary] Caught error:",r,s)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"h-screen flex items-center justify-center bg-[var(--bg-primary)] text-[var(--text-primary)]",children:e.jsxs("div",{className:"text-center p-8 max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Une erreur s'est produite"}),e.jsx("p",{className:"text-[var(--text-secondary)] mb-6",children:this.state.error?.message||"Erreur inconnue"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-[var(--accent)] text-[var(--bg-primary)] rounded-lg hover:opacity-90 transition-opacity",children:"Recharger la page"})]})}):this.props.children}}const hr={log:(...t)=>{},error:(...t)=>{console.error(...t)},warn:(...t)=>{},worker:(...t)=>{},sw:(...t)=>{},ai:(...t)=>{},three:(...t)=>{}};if("serviceWorker"in navigator){window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(r=>{r.addEventListener("updatefound",()=>{const s=r.installing;s&&s.addEventListener("statechange",()=>{s.state==="installed"&&navigator.serviceWorker.controller})}),setInterval(()=>{r.update()},60*60*1e3)}).catch(r=>{hr.error("[MORPHOS] Service Worker registration failed:",r)})});let t=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{t||(t=!0,window.location.reload())})}Ve.createRoot(document.getElementById("root")).render(e.jsx(_e.StrictMode,{children:e.jsx(ur,{children:e.jsx(pt,{children:e.jsx(xt,{children:e.jsx(mr,{})})})})}));
